{"kernelspec":{"display_name":"Python 2 (SageMath)","language":"python","name":"python2"},"language_info":{"codemirror_mode":{"name":"ipython","version":2},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython2","version":"2.7.10"}}
{"cell_type":"markdown","metadata":{},"source":"## Introduction\n\n在 Python standard library 中有 hashlib 這個 module。 他有包含 FIPS 的 secure hash algorithms 包含 SHA1, SHA224, SHA256, SHA384, 和 SHA512 和 RSA 的 MD5 algorithm。 Python 也支援 adler32 和 crc32 等定義於 zlib 的 hash functions。\n\nHash常被用於password儲存或file完整性檢查"}
{"cell_type":"code","execution_count":6,"metadata":{"collapsed":false,"trusted":true},"outputs":[{"data":{"text/plain":"'\\xb4\\xfb\\x1a\\xc0\\x18q]\\x02k\\xcfi\\x07\\x1f\\x89\\x19\\xaf'"},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":"import hashlib\nmd5 = hashlib.md5()\nmd5.update('Python!')\nmd5.digest()"}
{"cell_type":"code","execution_count":7,"metadata":{"collapsed":false,"trusted":true},"outputs":[{"data":{"text/plain":"'b4fb1ac018715d026bcf69071f8919af'"},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":"md5.hexdigest()"}
{"cell_type":"code","execution_count":9,"metadata":{"collapsed":false,"trusted":true},"outputs":[{"data":{"text/plain":"'cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e'"},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":"sha = hashlib.sha512(\"\").hexdigest()\nsha"}
{"cell_type":"markdown","metadata":{},"source":"Python 的 key derivation 在 standard library 中很少。 hashlib 只提供了 pbkdf2_hmac (PKCS#5 password-based key derivation function 2)。 他用 HMAC 的架構來當 psuedorandom function。他接受 salt 來防止 dictionary attacks 和 pre-computed rainbow tables。\n\n> 這類的hash通常設計運算的很慢，來防止破解~\n\n> 更多請見 https://password-hashing.net/"}
{"cell_type":"code","execution_count":13,"metadata":{"collapsed":false,"trusted":true},"outputs":[{"data":{"text/plain":"'20e3176afc2679908ffa3c28a2ef6cc190bd529b'"},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":"import binascii\ndk = hashlib.pbkdf2_hmac(hash_name='sha1',\n    password=b'bad_password34', \n    salt=b'bad_salt', \n    iterations=100000)\nbinascii.hexlify(dk)"}
{"cell_type":"code","execution_count":null,"metadata":{"collapsed":true,"trusted":true},"outputs":[],"source":""}