"{\"notebook_name\":\"03_ECC.ipynb\"}\n\"## ECC\\nThere are some great article that you may take a look: http://andrea.corbellini.name/tag/ecc/ , https://engineering.purdue.edu/kak/compsec/NewLectures/Lecture14.pdf , \\n\\nWith elliptic curves, we have two types of operations that we generally want to accomplish:\\n\\n- Digital signatures are the public key equivalent of message authentication codes. Alice signs a document using her private key, and users verify the signature against her public key.\\n- Encryption with elliptic curves is done by performing a key exchange. Alice uses a function called elliptic curve Diffie-Hellman (ECDH) to generate a shared key to encrypt messages to Bob.\\n\\nThere are three curves we generally use with elliptic curve cryptography:\\n\\n- the NIST P256 curve, which is equivalent to an AES-128 key (also known as secp256r1)\\n- the NIST P384 curve, which is equivalent to an AES-192 key (also known as secp384r1)\\n- the NIST P521 curve, which is equivalent to an AES-256 key (also known as secp521r1)\\n\\nAlternatively, there is the Curve25519 curve, which can be used for key exchange, and the Ed25519 curve, which can be used for digital signatures.\"︡{\"metadata\":{\"collapsed\":false,\"trusted\":false},\"cell_type\":\"markdown\"}\n\"### Generating Keys\\n\\nGenerating new keys with PyElliptic is done with the ECC class. As we used AES-256 previously, we’ll use P521 here.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"import pyelliptic\\ndef generate_key():\\n     return pyelliptic.ECC(curve='secp521r1')\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":1,\"outputs\":[]}\n\"Public and private keys can be exported (i.e. for storage) using the accessors (the examples shown are for Python 2).\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"curve = generate_key()\\npriv = curve.get_privkey()\\npub = curve.get_pubkey()\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":2,\"outputs\":[]}\n\"The keys can be imported when instantiating a instance of the ECC class\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"### Signing Messages\\n\\nNormally when we do signatures, we compute the hash of the message and sign that. PyElliptic does this for us, using SHA-512. Signing messages is done with the private key and some message. The algorithm used by PyElliptic for signatures is called ECDSA.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"def sign(key, msg):\\n    \\\"\\\"\\\"Sign a message with the ECDSA key.\\\"\\\"\\\"\\n    return key.sign(msg)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":3,\"outputs\":[]}\n\"In order to verify a message, we need the public key for the signing key, the message, and the signature. We’ll expect a serialised public key and perform the import to a pyelliptic.ecc.ECC instance internally.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"def verify(pub, msg, sig):\\n    \\\"\\\"\\\"Verify the signature on a message.\\\"\\\"\\\"\\n    return pyelliptic.ECC(curve='secp521r1', pubkey=pub).verify(sig, msg)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":4,\"outputs\":[]}\n\"### Encryption\\n\\nUsing elliptic curves, we encrypt using a function that generates a symmetric key using a public and private key pair. The function that we use, ECDH (elliptic curve Diffie-Hellman), works such that:\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"That is, ECDH with Alice’s private key and Bob’s public key returns the same shared key as ECDH with Bob’s private key and Alice’s public key.\\nWith pyelliptic, the private key used must be an instance of pyelliptic.ecc.ECC; the public key must be in serialised form.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"shared_key = curve.get_ecdh_key(pub)\\nlen(shared_key)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":5,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":5}]}\n\"def shared_key(curve, pub):\\n    \\\"\\\"\\\"Generate a new shared encryption key from a keypair.\\\"\\\"\\\"\\n    shared_key = curve.get_ecdh_key(pub)\\n    return shared_key\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":6,\"outputs\":[]}\n\"### Ephemeral keys\\n\\nFor improved security, we should use ephemeral keys for encryption; that is, we generate a new elliptic curve key pair for each encryption operation. This works as long as we send the public key with the message. Let’s look at a sample EC encryption function. For this function, we need the public key of our recipient, and we’ll pack our key into the beginning of the function. This method of encryption is called the elliptic curve integrated encryption scheme, or ECIES. (or more precise the key exchange is on the fly, so is ECDHE)\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"import struct\\nimport Crypto.Random.OSRNG.posix as RNG\\nimport Crypto.Cipher.AES as AES \\n__AES_KEYLEN = 32\\n\\ndef generate_nonce():\\n    \\\"\\\"\\\"Generate a random number used once.\\\"\\\"\\\"\\n    return RNG.new().read(AES.block_size)\\n\\ndef pad_data(data):\\n    \\\"\\\"\\\"pad_data pads out the data to an AES block length.\\\"\\\"\\\"\\n    # return data if no padding is required\\n    if len(data) % 16 == 0:\\n        return data\\n\\n    # subtract one byte that should be the 0x80\\n    # if 0 bytes of padding are required, it means only\\n    # a single \\\\x80 is required.\\n\\n    padding_required = 15 - (len(data) % 16)\\n\\n    data = '%s\\\\x80' % data\\n    data = '%s%s' % (data, '\\\\x00' * padding_required)\\n\\n    return data\\n\\ndef unpad_data(data):\\n    \\\"\\\"\\\"unpad_data removes padding from the data.\\\"\\\"\\\"\\n    if not data:\\n        return data\\n\\n    data = data.rstrip('\\\\x00')\\n    if data[-1] == '\\\\x80':\\n        return data[:-1]\\n    else:\\n        return data\\n\\ndef encrypt_02(data, key):\\n     \\\"\\\"\\\"\\n     Encrypt data using AES in CBC mode. The IV is prepended to the\\n     ciphertext.\\n     \\\"\\\"\\\"\\n     data = pad_data(data)\\n     ivec = generate_nonce()\\n     aes = AES.new(key, AES.MODE_CBC, ivec)\\n     ctxt = aes.encrypt(data)\\n     return ivec + ctxt\\n \\n \\ndef decrypt_02(ciphertext, key):\\n     \\\"\\\"\\\"\\n     Decrypt a ciphertext encrypted with AES in CBC mode; assumes the IV\\n     has been prepended to the ciphertext.\\n     \\\"\\\"\\\"\\n     if len(ciphertext) <= AES.block_size:\\n         raise Exception(\\\"Invalid ciphertext.\\\")\\n     ivec = ciphertext[:AES.block_size]\\n     ciphertext = ciphertext[AES.block_size:]\\n     aes = AES.new(key, AES.MODE_CBC, ivec)\\n     data = aes.decrypt(ciphertext)\\n     return unpad_data(data)\\n\\n\\ndef encrypt(pub, msg):\\n    \\\"\\\"\\\"\\n    Encrypt the message to the public key using ECIES. The public key\\n    should be a serialised public key.\\n    \\\"\\\"\\\"\\n    ephemeral = generate_key() # Alice's private key\\n    key = shared_key(ephemeral, pub) #symmetric key derives from ECDH(alice_priv, bob_pub)\\n    ephemeral_pub = struct.pack('>H', len(ephemeral.get_pubkey()))\\n    ephemeral_pub += ephemeral.get_pubkey() # Alice's public key\\n    return ephemeral_pub+encrypt_02(msg, key)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":7,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}]}\n\"Encryption packs the public key at the beginning, writing first a 16-bit unsigned integer containing the public key length and then appending the ephemeral public key and the ciphertext to this. Decryption needs to unpack the ephemeral public key (by reading the length and extracting that many bytes from the message) and then decrypting the message with the shared key.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"def decrypt(priv, msg):\\n    \\\"\\\"\\\"\\n    Decrypt an ECIES-encrypted message with the private key.\\n    \\\"\\\"\\\"\\n    ephemeral_len = struct.unpack('>H', msg[:2])[0]\\n    ephemeral_pub = msg[2:2+ephemeral_len] # Alice's public key\\n    key = shared_key(priv, ephemeral_pub) #symmetric key derives from ECDH(bob_priv, alice_pub)\\n    return decrypt_02(msg[2+ephemeral_len:], key)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":8,\"outputs\":[]}\n\"curve = generate_key()\\npub  = curve.get_pubkey()\\nplaintext = 'AG is god'\\nciphertext = encrypt(pub, plaintext)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":9,\"outputs\":[]}\n\"print decrypt(curve, ciphertext)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":10,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"AG is god\\n\",\"name\":\"stdout\"}]}\n\"curve = generate_key()\\ncurve.get_pubkey()\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":19,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"'\\\\x04\\\\x00\\\\xeb\\\\xeed\\\\xd9D\\\\xf4Fc\\\\xd3 \\\\xc29\\\\x82\\\\x81\\\\x00:\\\\x87\\\\xe7ya\\\"\\\\xb26\\\\xd4f\\\\xca\\\\x03XE)\\\\x8dH\\\\x88=\\\\x02#_\\\\xc8\\\"\\\\xceZ\\\\x08#\\\\x16\\\\xe6:K\\\\xa2]E\\\\x864f5<\\\\xb2\\\\x8e\\\\xd1\\\\xd6\\\\x9b<\\\\x93\\\\x11\\\\x90r\\\\x01DTmhU\\\\xb5\\\\xee\\\\xac\\\\xe5\\\\x83O\\\\xe7}J\\\\x88\\\\xeak\\\\x1dj\\\\x8a\\\\x9a\\\\xd7\\\\x98\\\\x1a\\\\x95\\\\xa0{>?\\\\xb1_\\\\x11\\\\xd3:\\\\x9bBI\\\\xa7u\\\\xc2\\\\xc9Xi\\\\xb8;\\\\xa8j\\\\x96\\\\xd2v+zW\\\\xf9w;FhIm\\\\xc5\\\\x1b9\\\\x0e%'\"},\"metadata\":{},\"execution_count\":19}]}\n\"curve = generate_key()\\ncurve.get_pubkey()\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":20,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"\\\"\\\\x04\\\\x01\\\\xb8\\\\x0e\\\\xc7\\\\xd2\\\\xd7\\\\xcb\\\\xe6\\\\r\\\\xbb\\\\x97NY\\\\xed+\\\\xfa\\\\x96\\\\xfa\\\\xc3\\\\x8b\\\\xd8Y\\\\x9c\\\\xf0\\\\x81\\\\x8bD\\\\xff\\\\x9a\\\\x89\\\\x01\\\\xe2\\\\x85\\\\xf9{\\\\x8eu{\\\\xc58Q\\\\x12/B\\\\xbd\\\\n(\\\\x1e\\\\x88\\\\x1a\\\\x18\\\\x17\\\\xf0\\\\xd6KR\\\\xa4B\\\\x83\\\\xaas\\\\xbf\\\\x93`q\\\\x9b\\\\x00\\\\xb8j\\\\xe8\\\\xc1\\\\xe9W\\\\x94\\\\x87w\\\\xfek\\\\x1aE\\\\x03\\\\xe6u\\\\x0c=]\\\\xe7\\\\x1f\\\\x80'W\\\\xf0\\\\xfd!\\\\xc3\\\\x18\\\\xf3\\\\xcf\\\\xbfC~z\\\\xd4lZI\\\\xe5\\\\xc9\\\\xa5]j\\\\x19I\\\\\\\\\\\\x86 \\\\x849\\\\x1d_B\\\\x05'\\\\xfd\\\\xccoCHm\\\\x92\\\\x122\\\"\"},\"metadata\":{},\"execution_count\":20}]}\n\"### Key Exchange\\n\\nSo how does Bob know the key actually belongs to Alice? There are two main schools of thought regarding the authentication of key ownership: centralised and decentralised. \\n\\nTLS/SSL follow the centralised school: a root certificate1 authority (CA) signs intermediary CA keys, which then sign user keys. For example, Bob can generate an SSL keypair. From this, he generates a certificate signing request, and sends this to the CA. The CA, usually after taking some money and ostensibly actually verifying Bob’s identity, then signs Bob’s certificate. Bob sets up his webserver to use his SSL certificate for all secure traffic, and Alice sees that the CA did in fact sign his certificate. This relies on trusted central authorities, Alice’s web browser would ship with a keystore of select trusted CA public keys (like VeriSigns) that she could use to verify signatures on the certificates from various sites. This system is called a public key infrastructure. \\n\\nThe other school of thought is followed by PGP - the decentralised model. In PGP, this is manifested as the Web of Trust. For example, if Carol now wants to talk to Bob and gives Bob her public key, Bob can check to see if Carol’s key has been signed by anyone else. We’ll also say that Bob knows for a fact that Alice’s key belongs to Alice, and he trusts her, and that Alice has signed Carol’s key. Bob sees Alice’s signature on Carol’s key and then can be reasonably sure that Carol is who she says it was. If we repeat the process with Dave, whose key was signed by Carol (whose key was signed by Alice), Bob might be able to be more certain that the key belongs to Dave, but maybe he doesn’t really trust Carol to properly verify identities. Bob can mark keys as having **various trust levels**, and from this a web of trust emerges: a picture of how well you can trust that a given key belongs to a given user.\\n\\nThe key distribution problem is not a quick and easy problem to solve; There are key exchange protocols (such as the Diffie-Hellman key exchange and IKE (which uses Diffie-Hellman) that provide alternatives to the web of trust and public key infrastructures.\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n\"import binascii\\n# Asymmetric encryption\\nalice = pyelliptic.ECC() # default curve: sect283r1\\nbob = pyelliptic.ECC(curve='sect571r1')\\n\\nciphertext = alice.encrypt(\\\"Hello Bob\\\", bob.get_pubkey(),\\n                           ephemcurve='sect571r1')\\nprint(bob.decrypt(ciphertext))\\n\\nsignature = bob.sign(\\\"Hello Alice\\\")\\n# alice's job :\\nprint(pyelliptic.ECC(pubkey=bob.get_pubkey(),\\n                     curve='sect571r1').verify(signature, \\\"Hello Alice\\\"))\\n\\n# ERROR !!!\\ntry:\\n    key = alice.get_ecdh_key(bob.get_pubkey())\\nexcept:\\n    print(\\\"For ECDH key agreement, the keys must be defined on the same curve !\\\")\\n\\nalice = pyelliptic.ECC(curve='sect571r1')\\nprint(binascii.hexlify(alice.get_ecdh_key(bob.get_pubkey())))\\nprint(binascii.hexlify(bob.get_ecdh_key(alice.get_pubkey())))\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":16,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"Hello Bob\\nTrue\\nFor ECDH key agreement, the keys must be defined on the same curve !\\n07a2558b289740048ca45ff31a4522b1dbd4226214d1a8c602cb76bc52833d1f\\n07a2558b289740048ca45ff31a4522b1dbd4226214d1a8c602cb76bc52833d1f\\n\",\"name\":\"stdout\"}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"
{"patch":[[[[0," is "],[-1,"ECDHE"],[0,")\"︡{"]],4724,4724,13,8]],"time":1458396753503}
{"patch":[[[[0,"the "],[-1,"fly, so is "],[0,")\"︡{"]],4713,4713,19,8]],"time":1458396749506}
{"patch":[[[[0,"y ex"],[-1,"change is on the "],[0,")\"︡{"]],4696,4696,25,8]],"time":1458396745515}
{"patch":[[[[0,"cise"],[-1," the key ex"],[0,")\"︡{"]],4685,4685,19,8]],"time":1458396741499}
{"patch":[[[[0,". (o"],[-1,"r more precise"],[0,")\"︡{"]],4671,4671,22,8]],"time":1458396737548}
{"patch":[[[[0,"S. ("],[-1,"o)"],[0,"\"︡{\""]],4670,4670,10,8]],"time":1458396733524}
{"patch":[[[[0,"r ECIES."],[-1," ("],[0,"\"︡{\"meta"]],4664,4664,18,16]],"time":1458396729679}
{"patch":[[[[0,"re14.pdf"],[-1," , "],[0,"\\n\\nWith"]],198,198,19,16]],"time":1458384560739}
{"patch":[[[[0,"/ , "],[-1,"https://engineering.purdue.edu/kak/compsec/NewLectures/Lecture14.pdf"],[0,"\\n\\n"]],134,134,76,8]],"time":1458384555484}
{"patch":[[[[0,"ecc/"],[-1," , "],[0,"\\n\\n"]],131,131,11,8]],"time":1458384548458}
{"patch":[[[[0,"look"],[-1,": http://andrea.corbellini.name/tag/ecc/"],[0,"\\n\\n"]],91,91,48,8]],"time":1458384544458}
{"patch":[[[[0,"you "],[-1,"may take a look"],[0,"\\n\\n"]],76,76,23,8]],"time":1458384540455}
{"patch":[[[[0,"hat you "],[1,"may "],[0,"\\n\\nWith"]],72,72,16,20]],"time":1458384536459}
{"patch":[[[[0,"cle "],[-1,"that you may "],[0,"\\n\\n"]],67,67,21,8]],"time":1458384532462}
{"patch":[[[[0,"eat "],[-1,"article "],[0,"\\n\\n"]],59,59,16,8]],"time":1458384528458}
{"patch":[[[[0," are"],[-1," some great "],[0,"\\n\\n"]],47,47,20,8]],"time":1458384524454}
{"patch":[[[[0,"## ECC\\n"],[-1,"There are"],[0,"\\n\\nWith"]],34,34,25,16]],"time":1458384520458}
{"patch":[[[[0,"# ECC\\n\\"],[-1,"n\\"],[0,"nWith el"]],35,35,18,16]],"time":1458384516454}
{"patch":[[[[0,"d by PGP"],[1,"4"],[0," - the d"]],10942,10942,16,17]],"time":1458384460486}
{"patch":[[[[0,"riv, ali"],[-1,"ce"],[0,"_pub)\\n "]],7989,7989,18,16]],"time":1458384359639}
{"patch":[[[[0,"b_priv, "],[-1,"ali"],[1,"bob"],[0,"_pub)\\n "]],7986,7986,19,19]],"time":1458384355455}
{"patch":[[[[0,"om ECDH("],[-1,"bob"],[1,"alic"],[0,"_priv, b"]],7976,7976,19,20]],"time":1458384347455}
{"patch":[[[[0,"CDH(alic"],[1,"e"],[0,"_priv, b"]],7980,7980,16,17]],"time":1458384343456}
{"patch":[[[[0,"key() # Alic"],[-1,"e"],[0,"'s private k"]],6472,6472,25,24]],"time":1458384337495}
{"patch":[[[[0,") # Alic"],[1,"e"],[0,"'s priva"]],6476,6476,16,17]],"time":1458384333468}
{"patch":[[[[0,"ub) "],[-1,"#symmetric key derives from ECDH(alice_priv, bob_pub)"],[1," "],[0,"\\n  "]],7947,7947,61,9]],"time":1458384297455}
{"patch":[[[[0,"ral_pub)"],[-1," "],[0," \\n    r"]],7942,7942,17,16]],"time":1458384293455}
{"patch":[[[[0,"ral_pub)"],[-1," "],[0,"\\n    re"]],7942,7942,17,16]],"time":1458384289463}
{"patch":[[[[0,"al_len] "],[-1,"# Alice's public key"],[0,"\\n    ke"]],7879,7879,36,16]],"time":1458384285628}
{"patch":[[[[0,"ral_len]"],[-1," "],[0,"\\n    ke"]],7878,7878,17,16]],"time":1458384280491}
{"patch":[[[[0,"lice's p"],[-1,"ublic"],[1,"rivat"],[0," key\\n  "]],6708,6708,21,21]],"time":1458384269455}
{"patch":[[[[0,") # "],[-1,"Alice's privat key"],[0,"\\n  "]],6703,6703,26,8]],"time":1458384265466}
{"patch":[[[[0,"pubkey()"],[-1," #"],[0," \\n    r"]],6696,6696,18,16]],"time":1458384261467}
{"patch":[[[[0,"pubkey()"],[-1," "],[0,"\\n    re"]],6696,6696,17,16]],"time":1458384257475}
{"patch":[[[[0,"priv"],[-1,", bob_pub"],[0,")\\n "]],6577,6577,17,8]],"time":1458384246498}
{"patch":[[[[0,"om ECDH("],[1,"bob_pub, "],[0,"alice_pr"]],6563,6563,16,25]],"time":1458384242475}
{"patch":[[[[0,"rom "],[-1,"ECDH(bob_pub, alice_priv)"],[0,"\\n  "]],6562,6562,33,8]],"time":1458384232854}
{"patch":[[[[0,"erives f"],[-1,"rom "],[0,"\\n    ep"]],6554,6554,20,16]],"time":1458384224476}
{"patch":[[[[0,"ey d"],[-1,"erives f"],[0,"\\n  "]],6550,6550,16,8]],"time":1458384220472}
{"patch":[[[[0,"tric key"],[-1," d"],[0,"\\n    ep"]],6544,6544,18,16]],"time":1458384216483}
{"patch":[[[[0,"ivate ke"],[-1,"y"],[0,"\\n    ke"]],6490,6490,17,16]],"time":1458384205518}
{"patch":[[[[0,"# Alice'"],[-1,"s private ke"],[0,"\\n    ke"]],6478,6478,28,16]],"time":1458384201459}
{"patch":[[[[0,"y() "],[-1,"# Alice'"],[0,"\\n  "]],6474,6474,16,8]],"time":1458384197457}
{"patch":[[[[0,"te_key()"],[-1," "],[0,"\\n    ke"]],6469,6469,17,16]],"time":1458384193456}
{"patch":[[[[0,"_count\":"],[-1,"19"],[1,"null"],[0,",\"output"]],8532,8532,18,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"'\\\\x04\\\\x00\\\\xeb\\\\xeed\\\\xd9D\\\\xf4Fc\\\\xd3 \\\\xc29\\\\x82\\\\x81\\\\x00:\\\\x87\\\\xe7ya\\\"\\\\xb26\\\\xd4f\\\\xca\\\\x03XE)\\\\x8dH\\\\x88=\\\\x02#_\\\\xc8\\\"\\\\xceZ\\\\x08#\\\\x16\\\\xe6:K\\\\xa2]E\\\\x864f5<\\\\xb2\\\\x8e\\\\xd1\\\\xd6\\\\x9b<\\\\x93\\\\x11\\\\x90r\\\\x01DTmhU\\\\xb5\\\\xee\\\\xac\\\\xe5\\\\x83O\\\\xe7}J\\\\x88\\\\xeak\\\\x1dj\\\\x8a\\\\x9a\\\\xd7\\\\x98\\\\x1a\\\\x95\\\\xa0{>?\\\\xb1_\\\\x11\\\\xd3:\\\\x9bBI\\\\xa7u\\\\xc2\\\\xc9Xi\\\\xb8;\\\\xa8j\\\\x96\\\\xd2v+zW\\\\xf9w;FhIm\\\\xc5\\\\x1b9\\\\x0e%'\"},\"metadata\":{},\"execution_count\":19}"],[0,"]}\n\""]],8552,8552,505,8],[[[0,"_count\":"],[-1,"20"],[1,"18"],[0,",\"output"]],8680,8680,18,18],[[[0,"n\":\""],[-1,"\\\"\\\\x04\\\\x01\\\\xb8\\\\x0e\\\\xc7\\\\xd2\\\\xd7\\\\xcb\\\\xe6\\\\r\\\\xbb\\\\x97NY\\\\xed+\\\\xfa\\\\x96\\\\xfa\\\\xc3\\\\x8b\\\\xd8Y\\\\x9c\\\\xf0\\\\x81\\\\x8bD\\\\xff\\\\x9a\\\\x89\\\\x01\\\\xe2\\\\x85\\\\xf9{\\\\x8eu{\\\\xc58Q\\\\x12/B\\\\xbd\\\\n(\\\\x1e\\\\x88\\\\x1a\\\\x18\\\\x17\\\\xf0\\\\xd6KR\\\\xa4B\\\\x83\\\\xaas\\\\xbf\\\\x93`q\\\\x9b\\\\x00\\\\xb8j\\\\xe8\\\\xc1\\\\xe9W\\\\x94\\\\x87w\\\\xfek\\\\x1aE\\\\x03\\\\xe6u\\\\x0c=]\\\\xe7\\\\x1f\\\\x80'W\\\\xf0\\\\xfd!\\\\xc3\\\\x18\\\\xf3\\\\xcf\\\\xbfC~z\\\\xd4lZI\\\\xe5\\\\xc9\\\\xa5]j\\\\x19I\\\\\\\\\\\\x86 \\\\x849\\\\x1d_B\\\\x05'\\\\xfd\\\\xccoCHm\\\\x92\\\\x122\\\""],[1,"<pyelliptic.ecc.ECC instance at 0x7f09a6f7ce18>"],[0,"\"},\""]],8752,8752,476,55],[[[0,"nt\":"],[-1,"20"],[1,"18"],[0,"}]}\n"]],8834,8834,10,10]],"time":1458384156460}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"17"],[0,",\"outputs\":[]}\n\""]],8524,8524,36,34],[[[0,"\":17,\"outputs\":["],[1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f09a6f4ba28>\"},\"metadata\":{},\"execution_count\":17}"],[0,"]}\n\"curve = gene"]],8538,8538,32,171],[[[0,"key()\\ncurve"],[-1,".get_pubkey()"],[0,"\"︡{\"metadata"]],8714,8714,37,24]],"time":1458384152464}
{"patch":[[[[0,"key()\\ncurve"],[-1,"."],[0,"get_pubkey()"]],8429,8429,25,24]],"time":1458384148466}
{"patch":[[[[0,")\\ncurve"],[-1,"get_pubkey()"],[0,"\"︡{\"meta"]],8433,8433,28,16]],"time":1458384144474}
{"patch":[[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],8739,8739,36,35],[[[0,"_count\":"],[-1,"18"],[1,"null"],[0,",\"output"]],8790,8790,18,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f09a6f7ce18>\"},\"metadata\":{},\"execution_count\":18}"],[0,"]}\n\""]],8810,8810,147,8]],"time":1458384129475}
{"patch":[[[[0,"]}\n\""],[-1,"curve = generate_key()\\ncurve"],[0,"\"︡{\""]],8680,8680,37,8]],"time":1458384125467}
{"patch":[[[[0,"}]}\n"],[-1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n"],[0,"\"###"]],8679,8679,113,8]],"time":1458384120474}
{"patch":[[[[0,"ey()\\ncu"],[-1,"rve"],[0,"\"︡{\"meta"]],8430,8430,19,16],[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],8464,8464,36,35],[[[0,"_count\":"],[-1,"17"],[1,"null"],[0,",\"output"]],8515,8515,18,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f09a6f4ba28>\"},\"metadata\":{},\"execution_count\":17}"],[0,"]}\n\""]],8535,8535,147,8]],"time":1458384115460}
{"patch":[[[[0,"ey()"],[-1,"\\ncu"],[0,"\"︡{\""]],8430,8430,12,8]],"time":1458384111455}
{"patch":[[[[0,"ut\"}]}\n\""],[-1,"curve = generate_key()"],[0,"\"︡{\"meta"]],8404,8404,38,16]],"time":1458384107459}
{"patch":[[[[0,"}]}\n"],[-1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n"],[0,"\"###"]],8407,8407,113,8]],"time":1458384102478}
{"patch":[[[[0,"count\":1"],[-1,"6"],[1,"5"],[0,",\"output"]],11495,11495,17,17],[[[0,"e\":\""],[-1,"stream\",\"text\":\"Hello Bob\\nTrue\\nFor ECDH key agreement, the keys must be defined on the same curve !\\n07a2558b289740048ca45ff31a4522b1dbd4226214d1a8c602cb76bc52833d1f\\n07a2558b289740048ca45ff31a4522b1dbd4226214d1a8c602cb76bc52833d1f\\n\",\"name\":\"stdou"],[1,"error\",\"ename\":\"UnboundLocalError\",\"evalue\":\"local variable 'own_key' referenced before assignment\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m                         Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-15-6fc1630dd142>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      5\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      6\\u001b[0m ciphertext = alice.encrypt(\\\"Hello Bob\\\", bob.get_pubkey(),\\n\\u001b[1;32m----> 7\\u001b[1;33m                            ephemcurve='secp521r1')\\n\\u001b[0m\\u001b[0;32m      8\\u001b[0m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdecrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mciphertext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      9\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(self, data, pubkey, ephemcurve, ciphername)\\u001b[0m\\n\\u001b[0;32m    500\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    501\\u001b[0m         return ECC.raw_encrypt(data, pubkey_x, pubkey_y, curve=curve,\\n\\u001b[1;32m--> 502\\u001b[1;33m                                ephemcurve=ephemcurve, ciphername=ciphername)\\n\\u001b[0m\\u001b[0;32m    503\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    504\\u001b[0m     \\u001b[1;33m@\\u001b[0m\\u001b[0mstaticmethod\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_encrypt\\u001b[1;34m(data, pubkey_x, pubkey_y, curve, ephemcurve, ciphername)\\u001b[0m\\n\\u001b[0;32m    508\\u001b[0m             \\u001b[0mephemcurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mcurve\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    509\\u001b[0m         \\u001b[0mephem\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mephemcurve\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 510\\u001b[1;33m         \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0msha512\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephem\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdigest\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    511\\u001b[0m         \\u001b[0mkey_e\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey_m\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m32\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m32\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    512\\u001b[0m         \\u001b[0mpubkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mephem\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key\\u001b[1;34m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    322\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    323\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_POINT_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 324\\u001b[1;33m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    325\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_priv_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    326\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m: local variable 'own_key' referenced before assignmen"],[0,"t\""],[1,"]"],[0,"}]}\n"]],11528,11528,260,5015]],"time":1458383912658}
{"patch":[[[[0," ephemcurve='sec"],[-1,"t57"],[1,"52"],[0,"1r1')\\nprint(bob"]],10844,10844,35,34]],"time":1458383908475}
{"patch":[[[[0,"rve='sec"],[1,"p"],[0,"521r1')\\"]],10852,10852,16,17]],"time":1458383904484}
{"patch":[[[[0," ephemcurve='sec"],[-1,"p"],[0,"521r1')\\nprint(b"]],10844,10844,33,32],[[[0,"count\":1"],[-1,"5"],[1,"4"],[0,",\"output"]],11494,11494,17,17],[[[0,"e\":\""],[-1,"UnboundLocalError\",\"evalue\":\"local variable 'own_key' referenced before assignment"],[1,"Exception\",\"evalue\":\"Unknown curve"],[0,"\",\"t"]],11543,11543,90,42],[[[0,"1b[1;31m"],[-1,"UnboundLocalError"],[1,"Exception"],[0,"\\u001b[0"]],11700,11700,33,25],[[[0,"        "],[1,"        "],[0,"Tracebac"]],11743,11743,16,24],[[[0,"ut-1"],[-1,"5-6fc1630dd142"],[1,"4-874036291198"],[0,">\\u0"]],11819,11819,22,22],[[[0,"emcurve='sec"],[-1,"p"],[1,"t"],[0,"521r1')\\n\\u0"]],12109,12109,25,25],[[[0,";32m    "],[1,"507\\u001b[0m         \\u001b[1;32mif\\u001b[0m \\u001b[0mephemcurve\\u001b[0m \\u001b[1;32mis\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    "],[0,"508\\u001"]],13687,13687,16,206],[[[0,"n\\u001b["],[-1,"0"],[1,"1"],[0,";32m"],[-1,"   "],[1,"-->"],[0," 509\\u00"]],14016,14016,24,24],[[[0,"> 509\\u001b["],[-1,"0"],[1,"1;33"],[0,"m         \\u"]],14031,14031,25,28],[[[0,"n\\u001b["],[-1,"1"],[1,"0m\\u001b[0"],[0,";32m"],[-1,"-->"],[1,"   "],[0," 510\\u00"]],14273,14273,24,33],[[[0,"  510\\u001b["],[-1,"1;33"],[1,"0"],[0,"m         \\u"]],14297,14297,28,25],[[[0,"[0m\\n\\u001b["],[-1,"0m\\u001b["],[0,"0;32m    511"]],14748,14748,33,24],[[[0,"0m\\n"],[1,"\",\""],[0,"\\u001b["],[-1,"0"],[1,"1"],[0,";32m"],[-1,"    512\\u001b[0m         \\u001b[0mpubkey"],[1,"/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m__init__\\u001b[1;34m(self, pubkey, privkey, pubkey_x, pubkey_y, raw_privkey, curve)\\u001b[0m\\n\\u001b[0;32m     75\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m     76"],[0,"\\u00"]],15154,15154,60,333],[[[0,"    76\\u001b[0m "],[1,"        "],[0,"\\u001b[1;33m=\\u0"]],15477,15477,32,40],[[[0,"      \\u001b[1;3"],[-1,"3m="],[1,"2mif"],[0,"\\u001b[0m \\u001b"]],15495,15495,35,36],[[[0,"01b[0m \\u001b[0m"],[-1,"ephem"],[1,"type"],[0,"\\u001b[0m\\u001b["]],15518,15518,37,36],[[[0,"b[0m\\u001b[1;33m"],[-1,"."],[1,"("],[0,"\\u001b[0m\\u001b["]],15543,15543,33,33],[[[0,"u001b[0m"],[-1,"get_pubkey"],[1,"curve\\u001b[0m\\u001b[1;33m)"],[0,"\\u001b[0"]],15570,15570,26,43],[[[0,"[1;33m)\\u001b[0m"],[1," "],[0,"\\u001b[1;33m(\\u0"]],15598,15598,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,"("],[1,"==\\u001b[0m \\u001b[0mstr"],[0,"\\u001b[0m\\u001b["]],15611,15611,33,56],[[[0,"u001b[0m\\u001b[1"],[-1,""],[1,""],[0,";33m"],[-1,")"],[1,":"],[0,"\\u001b[0m\\u001b["]],15652,15652,37,37],[[[0,"1b[0m\\u001b[0m\\n"],[-1,"\",\""],[0,"\\u001b[1;32m/pro"]],15698,15698,35,32],[[[0,";32m"],[-1,"/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key"],[1,"---> 77\\u001b[1;33m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mcurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_curve\\u001b[0m"],[0,"\\u00"]],15722,15722,176,205],[[[0,"[1;3"],[-1,"4m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    322"],[1,"3m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     78\\u001b[0m         \\u001b[1;32melse\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     79"],[0,"\\u00"]],15929,15929,66,241],[[[0,"       \\u001b[0m"],[-1,"OpenSSL"],[1,"self"],[0,"\\u001b[0m\\u001b["]],16181,16181,39,36],[[[0,"001b[0m\\u001b[0m"],[-1,"BN_fre"],[1,"curv"],[0,"e\\u001b[0m\\u001b"]],16225,16225,38,36],[[[0,"0mcurve\\u001b[0m"],[1," "],[0,"\\u001b[1;33m(\\u0"]],16239,16239,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,"("],[1,"="],[0,"\\u001b[0m\\u001b["]],16252,16252,33,33],[[[0,"[1;33m=\\u001b[0m"],[1," "],[0,"\\u001b[0mother_p"]],16262,16262,32,33],[[[0,"b[0m"],[-1,"other_pub_key_y"],[1,"curve"],[0,"\\u00"]],16284,16284,23,13],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"\\u001b[0m"],[0,"\\u001b[0m\\u001b["]],16298,16298,33,41],[[[0,"01b[0m\\u001b[0m\\"],[1,"n\",\"\\"],[0,"u001b[1;33m\\u001"]],16317,16317,32,37],[[[0,"[1;3"],[-1,"3m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    323"],[1,"2m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/openssl.pyc\\u001b[0m in \\u001b[0;36mget_curve\\u001b[1;34m(self, name)\\u001b[0m\\n\\u001b[0;32m    479\\u001b[0m         \\\"\\\"\\\"\\n"],[0,"\\u001b[0"],[1,";32"],[0,"m    "],[1,"480\\u001b[0m"],[0,"    "]],16343,16343,62,283],[[[0,"     \\u001b["],[-1,"0mOpenSSL"],[1,"1;32mif\\u001b[0m \\u001b[0mname\\u001b[0m \\u001b[1;32mnot"],[0,"\\u001b[0m\\u0"]],16626,16626,33,79],[[[0,";32mnot\\u001b[0m"],[1," "],[0,"\\u001b[1;33m.\\u0"]],16686,16686,32,33],[[[0,"1b[0m \\u001b[1;3"],[-1,"3m."],[1,"2min"],[0,"\\u001b[0m\\u001b["]],16697,16697,35,36],[[[0,"1;32min\\u001b[0m"],[1," "],[0,"\\u001b[0mEC_POIN"]],16710,16710,32,33],[[[0,"b[0m"],[-1,"EC_POINT_free"],[1,"self"],[0,"\\u00"]],16732,16732,21,12],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,"."],[0,"\\u001b[0m\\u001b["]],16745,16745,33,33],[[[0,"b[0m"],[-1,"other_pub_key"],[1,"curves"],[0,"\\u00"]],16776,16776,21,14],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,":"],[0,"\\u001b[0m\\u001b["]],16791,16791,33,33],[[[0,"--> "],[-1,"324"],[1,"481"],[0,"\\u00"]],16861,16861,11,11],[[[0,"01b["],[-1,"0mOpenSSL\\u001b[0m\\u001b[1;33m."],[1,"1;32mraise"],[0,"\\u00"]],16896,16896,39,18],[[[0,"2mraise\\u001b[0m"],[1," "],[0,"\\u001b[0mEC_KEY_"]],16903,16903,32,33],[[[0,"[0mE"],[-1,"C_KEY_free"],[1,"xception"],[0,"\\u00"]],16926,16926,18,16],[[[0,"01b["],[-1,"0mown_key"],[1,"1;34m\\\"Unknown curve\\\""],[0,"\\u00"]],16972,16972,17,30],[[[0,"    "],[-1,"325"],[1,"482"],[0,"\\u00"]],17082,17082,11,11],[[[0,"001b[0m         "],[-1,"   "],[1,"\\u001b[1;32mreturn\\u001b[0m"],[0," \\u001b[0mOpenSS"]],17091,17091,35,59],[[[0,"01b[0m \\u001b[0m"],[-1,"OpenSSL"],[1,"self"],[0,"\\u001b[0m\\u001b["]],17128,17128,39,36],[[[0,"b[0m"],[-1,"BN_free"],[1,"curves"],[0,"\\u00"]],17184,17184,15,14],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,"["],[0,"\\u001b[0m\\u001b["]],17199,17199,33,33],[[[0,"b[0m"],[-1,"own_priv_key"],[1,"name"],[0,"\\u00"]],17230,17230,20,12],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"]"],[0,"\\u001b[0m\\u001b["]],17243,17243,33,33],[[[0,"    "],[-1,"326"],[1,"483"],[0,"\\u00"]],17313,17313,11,11],[[[0,";31m"],[-1,"UnboundLocalError\\u001b[0m: local variable 'own_key' referenced before assignment"],[1,"Exception\\u001b[0m: Unknown curve"],[0,"\"]}]"]],17373,17373,89,41]],"time":1458383886715}
{"patch":[[[[0,"rve='sec"],[1,"t"],[0,"521r1')\\"]],10852,10852,16,17]],"time":1458383882467}
{"patch":[[[[0,"count\":1"],[-1,"4"],[1,"3"],[0,",\"output"]],11495,11495,17,17],[[[0,"e\":\""],[-1,"error\",\"ename\":\"Exception\",\"evalue\":\"Unknown curve\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mException\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-14-874036291198>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      5\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      6\\u001b[0m ciphertext = alice.encrypt(\\\"Hello Bob\\\", bob.get_pubkey(),\\n\\u001b[1;32m----> 7\\u001b[1;33m                            ephemcurve='sect521r1')\\n\\u001b[0m\\u001b[0;32m      8\\u001b[0m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdecrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mciphertext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      9\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(self, data, pubkey, ephemcurve, ciphername)\\u001b[0m\\n\\u001b[0;32m    500\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    501\\u001b[0m         return ECC.raw_encrypt(data, pubkey_x, pubkey_y, curve=curve,\\n\\u001b[1;32m--> 502\\u001b[1;33m                                ephemcurve=ephemcurve, ciphername=ciphername)\\n\\u001b[0m\\u001b[0;32m    503\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    504\\u001b[0m     \\u001b[1;33m@\\u001b[0m\\u001b[0mstaticmethod\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_encrypt\\u001b[1;34m(data, pubkey_x, pubkey_y, curve, ephemcurve, ciphername)\\u001b[0m\\n\\u001b[0;32m    507\\u001b[0m         \\u001b[1;32mif\\u001b[0m \\u001b[0mephemcurve\\u001b[0m \\u001b[1;32mis\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    508\\u001b[0m             \\u001b[0mephemcurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mcurve\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 509\\u001b[1;33m         \\u001b[0mephem\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mephemcurve\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    510\\u001b[0m         \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0msha512\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephem\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdigest\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    511\\u001b[0m         \\u001b[0mkey_e\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey_m\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m32\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m32\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m__init__\\u001b[1;34m(self, pubkey, privkey, pubkey_x, pubkey_y, raw_privkey, curve)\\u001b[0m\\n\\u001b[0;32m     75\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m     76\\u001b[0m         \\u001b[1;32mif\\u001b[0m \\u001b[0mtype\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m==\\u001b[0m \\u001b[0mstr\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 77\\u001b[1;33m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mcurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_curve\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     78\\u001b[0m         \\u001b[1;32melse\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     79\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mcurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mcurve\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/openssl.pyc\\u001b[0m in \\u001b[0;36mget_curve\\u001b[1;34m(self, name)\\u001b[0m\\n\\u001b[0;32m    479\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m    480\\u001b[0m         \\u001b[1;32mif\\u001b[0m \\u001b[0mname\\u001b[0m \\u001b[1;32mnot\\u001b[0m \\u001b[1;32min\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mcurves\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 481\\u001b[1;33m             \\u001b[1;32mraise\\u001b[0m \\u001b[0mException\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m\\\"Unknown curve\\\"\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    482\\u001b[0m         \\u001b[1;32mreturn\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mcurves\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[0mname\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    483\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mException\\u001b[0m: Unknown curve\"]"],[1,"stream\",\"text\":\"Hello Bob\\nTrue\\nFor ECDH key agreement, the keys must be defined on the same curve !\\n04ce7b213199864f7a4ca837b75b3a9cfcf736e97b60925ad21e636acd1d367d\\n04ce7b213199864f7a4ca837b75b3a9cfcf736e97b60925ad21e636acd1d367d\\n\",\"name\":\"stdout\""],[0,"}]}\n"]],11528,11528,5889,260]],"time":1458383860674}
{"patch":[[[[0,"e='sect5"],[-1,"2"],[1,"7"],[0,"1r1')\\np"]],10854,10854,17,17]],"time":1458383856467}
{"patch":[[[[0,"count\":1"],[-1,"3"],[1,"2"],[0,",\"output"]],11495,11495,17,17],[[[0," !\\n"],[-1,"04ce7b213199864f7a4ca837b75b3a9cfcf736e97b60925ad21e636acd1d367d\\n04ce7b213199864f7a4ca837b75b3a9cfcf736e97b60925ad21e636acd1d367d\\n\",\"name\":\"stdout\""],[1,"\",\"name\":\"stdout\"},{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'hexlify' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-12-81ea2c0cf90a>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m     20\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     21\\u001b[0m \\u001b[0malice\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[1;34m'sect571r1'\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 22\\u001b[1;33m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mhexlify\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     23\\u001b[0m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mhexlify\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'hexlify' is not defined\"]"],[0,"}]}\n"]],11631,11631,157,1731]],"time":1458383755504}
{"patch":[[[[0,"\\nprint("],[-1,"binascii.hexlify"],[0,"(bob.get"]],11353,11353,32,16]],"time":1458383751459}
{"patch":[[[[0,"\\nprint("],[1,"hexlbinascii.fy"],[0,"(bob.get"]],11353,11353,16,31]],"time":1458383746478}
{"patch":[[[[0,"inascii."],[1,"i"],[0,"fy(bob.g"]],11366,11366,16,17]],"time":1458383742466}
{"patch":[[[[0,"\\nprint("],[-1,"binascii."],[0,"hexlify("]],11290,11290,25,16],[[[0,"hexl"],[-1,"binascii."],[0,"ify("]],11352,11352,17,8]],"time":1458383730464}
{"patch":[[[[0," binasci"],[-1,"i"],[0,"\\n# Asym"]],10625,10625,17,16],[[[0,"count\":1"],[-1,"2"],[1,"1"],[0,",\"output"]],11476,11476,17,17],[[[0,"ut-1"],[-1,"2-81ea2c0cf90a"],[1,"1-5ca2c9e4c803"],[0,">\\u0"]],11955,11955,22,22],[[[0,"    "],[-1,"20"],[1,"19"],[0,"\\u00"]],12045,12045,10,10],[[[0,"2m     2"],[-1,"1"],[1,"0"],[0,"\\u001b[0"]],12103,12103,17,17],[[[0,"2m---> 2"],[-1,"2"],[1,"1"],[0,"\\u001b[1"]],12403,12403,17,17],[[[0,"2m     2"],[-1,"3"],[1,"2"],[0,"\\u001b[0"]],12849,12849,17,17]],"time":1458383707432}
{"patch":[[[[0,"\"}\n\""],[-1,"import binasci\\n"],[0,"# As"]],10615,10615,24,8]],"time":1458383703475}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":11,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"Hello Bob\\nTrue\\nFor ECDH key agreement, the keys must be defined on the same curve !\\n\",\"name\":\"stdout\"},{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'hexlify' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-11-5ca2c9e4c803>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m     19\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     20\\u001b[0m \\u001b[0malice\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mcurve\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[1;34m'sect571r1'\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 21\\u001b[1;33m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mhexlify\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     22\\u001b[0m \\u001b[1;32mprint\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mhexlify\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'hexlify' is not defined\"]}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],11419,11419,1955,8]],"time":1458383634433}
{"patch":[[[[0,"\"}\n\""],[-1,"# Asymmetric encryption\\nalice = pyelliptic.ECC() # default curve: sect283r1\\nbob = pyelliptic.ECC(curve='sect571r1')\\n\\nciphertext = alice.encrypt(\\\"Hello Bob\\\", bob.get_pubkey(),\\n                           ephemcurve='sect571r1')\\nprint(bob.decrypt(ciphertext))\\n\\nsignature = bob.sign(\\\"Hello Alice\\\")\\n# alice's job :\\nprint(pyelliptic.ECC(pubkey=bob.get_pubkey(),\\n                     curve='sect571r1').verify(signature, \\\"Hello Alice\\\"))\\n\\n# ERROR !!!\\ntry:\\n    key = alice.get_ecdh_key(bob.get_pubkey())\\nexcept:\\n    print(\\\"For ECDH key agreement, the keys must be defined on the same curve !\\\")\\n\\nalice = pyelliptic.ECC(curve='sect571r1')\\nprint(hexlify(alice.get_ecdh_key(bob.get_pubkey())))\\nprint(hexlify(bob.get_ecdh_key(alice.get_pubkey())))"],[0,"\"︡{\""]],10615,10615,770,8]],"time":1458383630511}
{"patch":[[[[0,"_count\":"],[-1,"10"],[1,"null"],[0,",\"output"]],8325,8325,18,20],[[[0,"s\":["],[-1,"{\"output_type\":\"stream\",\"text\":\"AG is god\\n\",\"name\":\"stdout\"}"],[0,"]}\n\""]],8345,8345,69,8]],"time":1458383541479}
{"patch":[[[[0,"nt\":"],[-1,"7,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],6772,6772,413,24],[[[0,"_count\":"],[-1,"8"],[1,"null"],[0,",\"output"]],7586,7586,17,20],[[[0,"_count\":"],[-1,"9"],[1,"null"],[0,",\"output"]],7804,7804,17,20]],"time":1458383537451}
{"patch":[[[[0,"_count\":"],[-1,"5"],[1,"null"],[0,",\"output"]],3626,3626,17,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":5}"],[0,"]}\n\""]],3646,3646,101,8],[[[0,"_count\":"],[-1,"6"],[1,"null"],[0,",\"output"]],3893,3893,17,20]],"time":1458383533487}
{"patch":[[[[0,"_count\":"],[-1,"3"],[1,"null"],[0,",\"output"]],2395,2395,17,20],[[[0,"_count\":"],[-1,"4"],[1,"null"],[0,",\"output"]],2905,2905,17,20]],"time":1458383529485}
{"patch":[[[[0,"_count\":"],[-1,"1"],[1,"null"],[0,",\"output"]],1425,1425,17,20],[[[0,"_count\":"],[-1,"2"],[1,"null"],[0,",\"output"]],1766,1766,17,20]],"time":1458383525526}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"4"],[0,",\"outputs\":[]}\n\""]],1417,1417,36,33],[[[0,"xecution_count\":"],[-1,"null"],[1,"53"],[0,",\"outputs\":[]}\n\""]],1755,1755,36,34],[[[0,"xecution_count\":"],[-1,"null"],[1,"50"],[0,",\"outputs\":[]}\n\""]],2388,2388,36,34],[[[0,"xecution_count\":"],[-1,"null"],[1,"51"],[0,",\"outputs\":[]}\n\""]],2896,2896,36,34],[[[0,"xecution_count\":"],[-1,"null"],[1,"56"],[0,",\"outputs\":[]}\n\""]],3621,3621,36,34],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":56}"],[0,"]}\n\"def shar"]],3639,3639,24,118],[[[0,"xecution_count\":"],[-1,"null"],[1,"6"],[0,",\"outputs\":[]}\n\""]],3980,3980,36,33],[[[0,"_count\":"],[-1,"null,\"outputs\":["],[1,"1,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}"],[0,"]}\n\"Encr"]],6773,6773,32,421],[[[0,"xecution_count\":"],[-1,"null"],[1,"9"],[0,",\"outputs\":[]}\n\""]],7972,7972,36,33],[[[0,"xecution_count\":"],[-1,"null"],[1,"7"],[0,",\"outputs\":[]}\n\""]],8187,8187,36,33],[[[0,"xecution_count\":"],[-1,"null"],[1,"10"],[0,",\"outputs\":[]}\n\""]],8322,8322,36,34],[[[0,"\":10,\"outputs\":["],[1,"{\"output_type\":\"stream\",\"text\":\"AG is god\\n\",\"name\":\"stdout\"}"],[0,"]}\n\"### Key Exch"]],8336,8336,32,93]],"time":1458383512441}
{"patch":[[[[0,"}\n\"shared_key = "],[1,"Bob_"],[0,"curve.get_ecdh_k"]],3495,3495,32,36]],"time":1458383374475}
{"patch":[[[[0,"d_key = "],[-1,"c"],[1,"C"],[0,"urve.get"]],3861,3861,17,17]],"time":1458383370471}
{"patch":[[[[0,"red_key("],[-1,"c"],[1,"C"],[0,"urve, pu"]],3760,3760,17,17]],"time":1458383366483}
{"patch":[[[[0,"\":56}]}\n"],[1,"\"\"︡{\"metadata\":{},\"cell_type\":\"markdown\"}\n"],[0,"\"def sha"]],3744,3744,16,58]],"time":1458383355482}
{"patch":[[[[0,":56}]}\n\""],[1,"Our shared key is 32 bytes; this is enough for AES-256 and HMAC-SHA-256. What about HMAC-SHA-256? We could use a short key, or we could expand the last 32 bytes of the key using SHA-384 (which produces a 48-byte hash). Here’s a function to do that:"],[0,"\"︡{\"meta"]],3745,3745,16,264]],"time":1458383351483}
{"patch":[[[[0,"ts\":[]}\n"],[1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":54,\"outputs\":[]}\n"],[0,"\"The key"]],1780,1780,16,120]],"time":1458383342466}
{"patch":[[[[0,"ey()"],[-1,"\\npub = curve.get_pubkey()"],[0,"\"︡{\""]],1655,1655,34,8]],"time":1458383338471}
{"patch":[[[[0,"s\":[]}\n\""],[1,"pub = curve.get_pubkey()"],[0,"\"︡{\"meta"]],1755,1755,16,40]],"time":1458383334472}
{"patch":[[[[0,"\n\"pub = "],[1,"Alice_"],[0,"curve.ge"]],1761,1761,16,22]],"time":1458383330475}
{"patch":[[[[0,"npriv = "],[1,"Alice_"],[0,"curve.ge"]],1632,1632,16,22]],"time":1458383326467}
{"patch":[[[[0,"kdown\"}\n\"curve ="],[1," generate_key()\\n_curve ="],[0," generate_key()\\"]],1600,1600,32,57]],"time":1458383322471}
{"patch":[[[[0,"down\"}\n\""],[1,"Alic"],[0,"curve = "]],1601,1601,16,20],[[[0,"_key()\\n"],[1,"Bob"],[0,"_curve ="]],1629,1629,16,19]],"time":1458383318467}
{"patch":[[[[0,"\"}\n\"Alic"],[1,"e_"],[0,"curve = "]],1605,1605,16,18]],"time":1458383314475}
{"patch":[[[[0,"decrypt("],[-1,"curve"],[1,"key"],[0,", cipher"]],8668,8668,21,19]],"time":1458383309463}
{"patch":[[[[0,"npub  = "],[-1,"curve"],[1,"key"],[0,".get_pub"]],8470,8470,21,19]],"time":1458383305463}
{"patch":[[[[0,"text = 'AG i"],[1,"curve"],[0,"s god'\\nciph"]],8501,8501,24,29]],"time":1458383301467}
{"patch":[[[[0," = 'AG i"],[-1,"curve"],[0,"s god'\\n"]],8505,8505,21,16]],"time":1458383297479}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"c"],[1,"C"],[0,"urve = g"]],8439,8439,17,17]],"time":1458383290487}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"Curve"],[1,"k"],[0," = gener"]],8439,8439,21,17]],"time":1458383286478}
{"patch":[[[[0,"\":[]}\n\"k"],[1,"ey"],[0," = gener"]],8440,8440,16,18]],"time":1458383282478}
{"patch":[[[[0," and IKE"],[1,"8"],[0," (which "]],10904,10904,16,17]],"time":1458383246482}
{"patch":[[[[0,"exchange"],[1,"7"],[0," and IKE"]],10896,10896,16,17]],"time":1458383236467}
{"patch":[[[[0,"o solve;"],[1," a lot of very smart people have spent a lot of time coming up with solutions to the problem."],[0," There a"]],10822,10822,16,109]],"time":1458383231481}
{"patch":[[[[0," having "],[-1,"**"],[0,"various "]],10607,10607,18,16]],"time":1458383213464}
{"patch":[[[[0,"vels"],[-1,"**"],[0,", an"]],10631,10631,10,8]],"time":1458383209464}
{"patch":[[[[0,"usts her"],[1,"6"],[0,", and th"]],10192,10192,16,17]],"time":1458383177464}
{"patch":[[[[0,"of Trust"],[1,"5"],[0,". For ex"]],9952,9952,16,17]],"time":1458383160851}
{"patch":[[[[0,"d model."],[-1," "],[1,"\\n\\n"],[0,"In PGP, "]],9905,9905,17,20]],"time":1458383156851}
{"patch":[[[[0,"ucture. "],[-1,"\\n\\n"],[0,"The othe"]],9827,9827,20,16]],"time":1458383152851}
{"patch":[[[[0,"rities, "],[1,"like VeriSig"],[0,"Alice’s "]],9599,9599,16,28]],"time":1458383142467}
{"patch":[[[[0," VeriSig"],[1,"n3 "],[0,"Alice’s "]],9611,9611,16,19]],"time":1458383138475}
{"patch":[[[[0,"alised. "],[-1,"\\n"],[0,"\\nTLS/SS"]],9037,9037,18,16]],"time":1458383105469}
{"patch":[[[[0,"alised. "],[-1,"\\n"],[0,"TLS/SSL "]],9037,9037,18,16]],"time":1458383101464}
{"patch":[[[[0,"identity"],[1,"2"],[0,", then s"]],9381,9381,16,17]],"time":1458383091475}
{"patch":[[[[0,"ample, B"],[-1,"ob"],[0," can gen"]],9180,9180,18,16]],"time":1458383079478}
{"patch":[[[[0,"xample, "],[-1,"B"],[1,"if Bob runs Foo Widgets, LLC, he"],[0," can gen"]],9179,9179,17,48]],"time":1458383075467}
{"patch":[[[[0,"_count\":"],[-1,"10"],[1,"8"],[0,",\"output"]],8766,8766,18,17],[[[0,"e\":\""],[-1,"stream\",\"text\":\"AG is god\\n\",\"name\":\"stdout\""],[1,"error\",\"ename\":\"NameError\",\"evalue\":\"global name 'secretkey' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-8-ac4b66004002>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[1;32mprint\\u001b[0m \\u001b[0mdecrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mciphertext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-2-64998de4bc06>\\u001b[0m in \\u001b[0;36mdecrypt\\u001b[1;34m(priv, msg)\\u001b[0m\\n\\u001b[0;32m      6\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mephemeral_len\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      7\\u001b[0m     \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mephemeral_pub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 8\\u001b[1;33m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0msecretkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdecrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mephemeral_len\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: global name 'secretkey' is not defined\"]"],[0,"}]}\n"]],8799,8799,52,1818]],"time":1458382991459}
{"patch":[[[[0," return "],[1,"sec"],[0,"decrypt_"]],8299,8299,16,19],[[[0,"_count\":"],[-1,"9"],[1,"2"],[0,",\"output"]],8425,8425,17,17]],"time":1458382987463}
{"patch":[[[[0,"turn sec"],[1,"retkey."],[0,"decrypt_"]],8302,8302,16,23]],"time":1458382983477}
{"patch":[[[[0,"_count\":"],[-1,"8"],[1,"46"],[0,",\"output"]],8776,8776,17,18],[[[0,"ename\":\""],[-1,"Nam"],[1,"Attribut"],[0,"eError\","]],8822,8822,19,24],[[[0,"e\":\""],[-1,"global name 'secretkey' is not defined"],[1,"'str' object has no attribute 'get_ecdh_key'"],[0,"\",\"t"]],8852,8852,46,52],[[[0,"m\",\"\\u001b[1;31m"],[-1,"Nam"],[1,"Attribut"],[0,"eError\\u001b[0m "]],9011,9011,35,40],[[[0,"        "],[-1,"     "],[0,"Tracebac"]],9070,9070,21,16],[[[0,"put-"],[-1,"8-ac4b66004002"],[1,"46-2870f10de34d"],[0,">\\u0"]],9137,9137,22,23],[[[0,"001b[0m\\u001b[0m"],[-1,"key"],[1,"priv"],[0,"\\u001b[0m\\u001b["]],9314,9314,35,36],[[[0,"n-input-"],[-1,"2"],[1,"44"],[0,"-64998de"]],9479,9479,17,18],[[[0,"2m      "],[1,"5\\u001b[0m     \\u001b[0mephemeral_len\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0munpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m0\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      "],[0,"6\\u001b["]],9579,9579,16,473],[[[0,"n\\u001b["],[-1,"0"],[1,"1"],[0,";32m"],[-1,"     "],[1,"---->"],[0," 7\\u001b"]],10329,10329,26,26],[[[0,"--> 7\\u001b["],[-1,"0"],[1,"1;33"],[0,"m     \\u001b"]],10344,10344,25,28],[[[0,"n\\u001b["],[-1,"1;32m---->"],[1,"0m\\u001b[0;32m     "],[0," 8\\u001b"]],10590,10590,26,35],[[[0,"    8\\u001b["],[-1,"1;33"],[1,"0"],[0,"m     \\u001b"]],10614,10614,28,25],[[[0,"0m\\n"],[-1,"\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: global name 'secretkey' is not defined"],[1,"\",\"\\u001b[1;32m<ipython-input-19-883155f528df>\\u001b[0m in \\u001b[0;36mshared_key\\u001b[1;34m(priv, pub)\\u001b[0m\\n\\u001b[0;32m      1\\u001b[0m \\u001b[1;32mdef\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      2\\u001b[0m     \\u001b[1;34m\\\"\\\"\\\"Generate a new shared encryption key from a keypair.\\\"\\\"\\\"\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 3\\u001b[1;33m     \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpriv\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      4\\u001b[0m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mAttributeError\\u001b[0m: 'str' object has no attribute 'get_ecdh_key'"],[0,"\"]}]"]],11016,11016,90,992]],"time":1458382972628}
{"patch":[[[[0,"_count\":"],[-1,"7"],[1,"5"],[0,",\"output"]],8643,8643,17,17],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"global name 'shared_key' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-5-ade6d14507a0>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      2\\u001b[0m \\u001b[0mpub\\u001b[0m  \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 4\\u001b[1;33m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-1-06a8e66be203>\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(pub, msg)\\u001b[0m\\n\\u001b[0;32m     68\\u001b[0m     \\\"\\\"\\\"\\n\\u001b[0;32m     69\\u001b[0m     \\u001b[0mephemeral\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 70\\u001b[1;33m     \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;31m#symmetric key\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     71\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     72\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m+=\\u001b[0m \\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: global name 'shared_key' is not defined\"]}"],[0,"]}\n\"print de"]],8652,8652,24,2488]],"time":1458382968444}
{"patch":[[[[0,"_count\":"],[-1,"6"],[1,"null"],[0,",\"output"]],4430,4430,17,20]],"time":1458382964468}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"57"],[0,",\"outputs\":[]}\n\""]],4422,4422,36,34]],"time":1458382960471}
{"patch":[[[[0,"nt\":"],[-1,"5,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"global name 'shared_key' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-5-ade6d14507a0>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      2\\u001b[0m \\u001b[0mpub\\u001b[0m  \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 4\\u001b[1;33m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-1-06a8e66be203>\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(pub, msg)\\u001b[0m\\n\\u001b[0;32m     68\\u001b[0m     \\\"\\\"\\\"\\n\\u001b[0;32m     69\\u001b[0m     \\u001b[0mephemeral\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 70\\u001b[1;33m     \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;31m#symmetric key\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     71\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     72\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m+=\\u001b[0m \\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: global name 'shared_key' is not defined\"]}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],8648,8648,2485,24]],"time":1458382953443}
{"patch":[[[[0,"_count\":"],[-1,"null,\"outputs\":["],[1,"3,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'generate_key' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-3-ade6d14507a0>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mpub\\u001b[0m  \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      4\\u001b[0m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'generate_key' is not defined\"]}"],[0,"]}\n\"prin"]],8644,8644,32,1313]],"time":1458382949442}
{"patch":[[[[0,"count\":4"],[1,"7"],[0,",\"output"]],1426,1426,16,17]],"time":1458382927854}
{"patch":[[[[0,"nt\":"],[-1,"1,\"outputs\":[{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],7221,7221,413,24],[[[0,"_count\":"],[-1,"2"],[1,"59"],[0,",\"output"]],8045,8045,17,18],[[[0,"_count\":"],[-1,"3"],[1,"45"],[0,",\"output"]],8257,8257,17,18],[[[0,"s\":["],[-1,"{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'generate_key' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-3-ade6d14507a0>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mpub\\u001b[0m  \\u001b[1;33m=\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      4\\u001b[0m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'generate_key' is not defined\"]}"],[0,"]}\n\""]],8275,8275,1292,8]],"time":1458382911484}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"58"],[0,",\"outputs\":[]}\n\""]],7209,7209,36,34]],"time":1458382907463}
{"patch":[[[[0,"#symmetr"],[-1,"ic key"],[0,"\\n    ep"]],6965,6965,22,16]],"time":1458382866478}
{"patch":[[[[0,"ub) "],[-1,"#symmetr"],[0,"\\n  "]],6961,6961,16,8]],"time":1458382862478}
{"patch":[[[[0,"al, pub)"],[-1," "],[0,"\\n    ep"]],6956,6956,17,16]],"time":1458382858479}
{"patch":[[[[0,"    \\\"\\\"\\\"\\n    "],[1,"#"],[0,"ephemeral = gene"]],6884,6884,32,33]],"time":1458382846466}
{"patch":[[[[0,"pt(priv, msg"],[1,", Curve"],[0,"):\\n    \\\"\\\""]],7651,7651,24,31]],"time":1458382823467}
{"patch":[[[[0,"ypt(pub, msg"],[1,", Curve"],[0,"):\\n    \\\"\\\""]],6745,6745,24,31]],"time":1458382819486}
{"patch":[[[[0,"decrypt("],[-1,"key"],[1,"pri"],[0,", cipher"]],8287,8287,19,19]],"time":1458382805470}
{"patch":[[[[0,"rypt(pri"],[1,"v"],[0,", cipher"]],8290,8290,16,17]],"time":1458382801468}
{"patch":[[[[0,"b, plain"],[-1,"text"],[0,")\"︡{\"met"]],8164,8164,20,16]],"time":1458382781483}
{"patch":[[[[0,"pt(pub, "],[-1,"plain"],[1,"ephemeral"],[0,")\"︡{\"met"]],8159,8159,21,25]],"time":1458382777480}
{"patch":[[[[0,"npub  = "],[-1,"key"],[1,"priv"],[0,".get_pub"]],8090,8090,19,20],[[[0,".get_pubkey("],[1,"p"],[0,")\\nplaintext"]],8102,8102,24,25]],"time":1458382747480}
{"patch":[[[[0,"pubkey(p"],[1,"ub"],[0,")\\nplain"]],8107,8107,16,18]],"time":1458382743488}
{"patch":[[[[0,".get_pub"],[-1,"key"],[0,"(pub)\\np"]],8102,8102,19,16]],"time":1458382734471}
{"patch":[[[[0,"riv.get_"],[-1,"pub"],[1,"ecdh_key"],[0,"(pub)\\np"]],8099,8099,19,24]],"time":1458382719479}
{"patch":[[[[0,":[]}\n\"ke"],[-1,"y"],[0," = gener"]],8063,8063,17,16]],"time":1458382715468}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"ke"],[1,"priv"],[0," = gener"]],8061,8061,18,20]],"time":1458382711476}
{"patch":[[[[0," = priv."],[-1,"get_ecdh_key(pub)"],[0,"\\nplaint"]],8096,8096,33,16]],"time":1458382501468}
{"patch":[[[[0,"= pr"],[-1,"iv."],[0,"\\npl"]],8097,8097,11,8]],"time":1458382454477}
{"patch":[[[[0,"npub  = "],[-1,"pr"],[1,"te_key()"],[0,"\\nplaint"]],8091,8091,18,24]],"time":1458382450476}
{"patch":[[[[0,"()\\npub "],[-1," "],[0,"= "],[1,"genera"],[0,"te_key()"]],8088,8088,19,24]],"time":1458382446472}
{"patch":[[[[0,"key()\\np"],[-1,"ub"],[1,"riv"],[0," = gener"]],8085,8085,18,19]],"time":1458382442471}
{"patch":[[[[0,"\n\"priv ="],[-1," generate_key()\\npriv ="],[0," generat"]],8067,8067,39,16]],"time":1458382438472}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"priv"],[1,"PRI"],[0," = gener"]],8061,8061,20,19]],"time":1458382434471}
{"patch":[[[[0,"]}\n\""],[-1,"PRI"],[1,"ephemeral"],[0," = g"]],8065,8065,11,17]],"time":1458382430476}
{"patch":[[[[0,"pt(pub, "],[-1,"ephemeral"],[1,"plaintext"],[0,")\"︡{\"met"]],8140,8140,25,25]],"time":1458381501476}
{"patch":[[[[0,"]}\n\""],[-1,"ephemeral = generate_key()"],[0,"\\npl"]],8065,8065,34,8]],"time":1458381495479}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"\\n"],[0,"plaintex"]],8061,8061,18,16]],"time":1458381491477}
{"patch":[[[[0,"pt(priv, msg"],[-1,", Curve"],[0,"):\\n    \\\"\\\""]],7658,7658,31,24]],"time":1458381485488}
{"patch":[[[[0,"ral, pub"],[1,", Cur"],[0,")\\n    e"]],6963,6963,16,21]],"time":1458381481508}
{"patch":[[[[0,"pub, Cur"],[1,"ve"],[0,")\\n    e"]],6968,6968,16,18]],"time":1458381477490}
{"patch":[[[[0,", pub, C"],[-1,"urve"],[0,")\\n    e"]],6966,6966,20,16]],"time":1458381469496}
{"patch":[[[[0,"ral, pub"],[-1,", C"],[0,")\\n    e"]],6963,6963,19,16]],"time":1458381465484}
{"patch":[[[[0,"b, msg, "],[-1,"Curve"],[0,"):\\n    "]],6751,6751,21,16]],"time":1458381461479}
{"patch":[[[[0,"pub, msg"],[-1,", "],[0,"):\\n    "]],6749,6749,18,16]],"time":1458381457488}
{"patch":[[[[0,"\\\"\\n    "],[-1,"#"],[0,"ephemera"]],6892,6892,17,16]],"time":1458381418491}
{"patch":[[[[0,"nt\":"],[-1,"59"],[1,"44"],[0,",\"ou"]],8032,8032,10,10]],"time":1458371684365}
{"patch":[[[[0,"nt\":"],[-1,"57"],[1,"19"],[0,",\"ou"]],4435,4435,10,10],[[[0,"nt\":"],[-1,"58"],[1,"40"],[0,",\"ou"]],7206,7206,10,10]],"time":1458371680359}
{"patch":[[[[0,"count\":5"],[-1,"6"],[1,"5"],[0,",\"output"]],3783,3783,17,17],[[[0,"\":\"e"],[-1,"xecute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":56"],[1,"rror\",\"ename\":\"NameError\",\"evalue\":\"name 'Bob_Curve' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-55-c8bdc66413ab>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mBob_Curve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'Bob_Curve' is not defined\"]"],[0,"}]}\n"]],3817,3817,84,881]],"time":1458371672327}
{"patch":[[[[0,"d_key = Bob_"],[-1,"c"],[1,"C"],[0,"urve.get_ecd"]],3652,3652,25,25]],"time":1458371668350}
{"patch":[[[[0,"count\":5"],[-1,"5"],[1,"2"],[0,",\"output"]],3783,3783,17,17],[[[0,"\":\"e"],[-1,"rror\",\"ename\":\"NameError\",\"evalue\":\"name 'Bob_Curve' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-55-c8bdc66413ab>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mBob_Curve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: name 'Bob_Curve' is not defined\"]"],[1,"xecute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":52"],[0,"}]}\n"]],3817,3817,881,84]],"time":1458371660904}
{"patch":[[[[0,"y = Bob_"],[-1,"Curve"],[0,".get_ecd"]],3656,3656,21,16]],"time":1458371656905}
{"patch":[[[[0,"d_key = "],[-1,"Bob_"],[0,".get_ecd"]],3652,3652,20,16]],"time":1458371652925}
{"patch":[[[[0,"d_key = "],[1,"generate_key()"],[0,".get_ecd"]],3652,3652,16,30]],"time":1458371632350}
{"patch":[[[[0,"d_key = "],[-1,"generate_key()"],[1,"Curve"],[0,".get_ecd"]],3652,3652,30,21]],"time":1458371628346}
{"patch":[[[[0,"nt\":"],[-1,"53"],[1,"48"],[0,",\"ou"]],1782,1782,10,10],[[[0,"nt\":"],[-1,"5"],[0,"4"],[1,"9"],[0,",\"ou"]],1916,1916,10,10]],"time":1458371618372}
{"patch":[[[[0,"curve = "],[-1,"generate_key()"],[0,"\\npriv ="]],1644,1644,30,16]],"time":1458371614374}
{"patch":[[[[0,"ob_curve"],[-1," = "],[0,"\\npriv ="]],1641,1641,19,16]],"time":1458371610359}
{"patch":[[[[0,"()\\n"],[-1,"Bob_curve"],[0,"\\npr"]],1636,1636,17,8]],"time":1458371606349}
{"patch":[[[[0,"e_key()\\"],[-1,"n\\"],[0,"npriv = "]],1631,1631,18,16]],"time":1458371602346}
{"patch":[[[[0,"\n\"pub = "],[-1,"Alice_c"],[1,"C"],[0,"urve.get"]],1774,1774,23,17]],"time":1458371598365}
{"patch":[[[[0,"npriv = "],[-1,"Alice_c"],[1,"C"],[0,"urve.get"]],1639,1639,23,17]],"time":1458371594355}
{"patch":[[[[0,"\n\"Al"],[-1,"ice_c"],[1,"C"],[0,"urve"]],1608,1608,13,9]],"time":1458371579349}
{"patch":[[[[0,"down\"}\n\""],[-1,"Al"],[0,"Curve = "]],1602,1602,18,16]],"time":1458371575354}
{"patch":[[[[0,"red_key("],[-1,"Curve"],[1,"priv"],[0,", pub):\\"]],4149,4149,21,20]],"time":1458371557374}
{"patch":[[[[0,"   shared_key = "],[-1,"Curve"],[0,".get_ecdh_key(pu"]],4241,4241,37,32]],"time":1458371553350}
{"patch":[[[[0,"d_key = "],[1,"priv"],[0,".get_ecd"]],4249,4249,16,20]],"time":1458371549357}
{"patch":[[[[0,"_count\":"],[-1,"52"],[1,"17"],[0,",\"output"]],3732,3732,18,18],[[[0,"_count\":"],[-1,"52"],[1,"17"],[0,"}]}\n\"Our"]],3837,3837,18,18]],"time":1458371341358}
{"patch":[[[[0,"d_key = "],[-1,"Curve"],[1,"key"],[0,".get_ecd"]],3606,3606,21,19]],"time":1458371337361}
{"patch":[[[[0,"_count\":"],[-1,"5"],[0,"1"],[1,"4"],[0,",\"output"]],3007,3007,18,18]],"time":1458371333354}
{"patch":[[[[0,"nt\":"],[-1,"50"],[1,"13"],[0,",\"ou"]],2503,2503,10,10]],"time":1458371329402}
{"patch":[[[[0,"nt\":"],[-1,"47"],[1,"2"],[0,",\"ou"]],1429,1429,10,9],[[[0,"_count\":"],[-1,"48"],[1,"23"],[0,",\"output"]],1737,1737,18,18],[[[0,"_count\":"],[1,"2"],[0,"4"],[-1,"9"],[0,",\"output"]],1865,1865,18,18]],"time":1458371324350}
{"patch":[[[[0,"npriv = "],[-1,"Curve"],[1,"k"],[0,".get_pri"]],1632,1632,21,17],[[[0,"\n\"pub = "],[-1,"Curve"],[1,"key"],[0,".get_pub"]],1757,1757,21,19]],"time":1458371320351}
{"patch":[[[[0,"priv = k"],[1,"ey"],[0,".get_pri"]],1633,1633,16,18]],"time":1458371316350}
{"patch":[[[[0,"down\"}\n\""],[-1,"Curve"],[1,"k"],[0," = gener"]],1601,1601,21,17]],"time":1458371312350}
{"patch":[[[[0,"own\"}\n\"k"],[1,"ey"],[0," = gener"]],1602,1602,16,18]],"time":1458371308355}
{"patch":[[[[0,"count\":4"],[-1,"4"],[1,"1"],[0,",\"output"]],7968,7968,17,17],[[[0,"count\":4"],[-1,"5"],[1,"2"],[0,",\"output"]],8133,8133,17,17],[[[0,"count\":4"],[-1,"6"],[1,"3"],[0,",\"output"]],8268,8268,17,17],[[[0,"ename\":\""],[-1,"Attribut"],[1,"Typ"],[0,"eError\","]],8313,8313,24,19],[[[0,"e\":\""],[-1,"'str' object has no attribute 'get_ecdh_key"],[1,"unsupported operand type(s) for +: 'int' and 'tuple"],[0,"'\",\""]],8338,8338,51,59],[[[0,"\\u001b[1;31m"],[-1,"Attribut"],[1,"Typ"],[0,"eError\\u001b"]],8509,8509,32,27],[[[0,"        "],[1,"     "],[0,"Tracebac"]],8559,8559,16,21],[[[0,"-input-4"],[-1,"6"],[1,"3"],[0,"-2870f10"]],8628,8628,17,17],[[[0,"ut-4"],[-1,"4-64998de4bc06"],[1,"1-77a7e78c6a57"],[0,">\\u0"]],8978,8978,22,22],[[[0,"2m      "],[1,"4\\u001b[0m     \\\"\\\"\\\"\\n\\u001b[0;32m      "],[0,"5\\u001b["]],9073,9073,16,57],[[[0,"b[0m\\u001b[1;33m"],[-1,"["],[0,"\\u001b[0m\\u001b["]],9459,9459,33,32],[[[0,"01b["],[-1,"1;36m0\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     "],[1,"0m\\n\\u001b[1;32m---->"],[0," 6\\u"]],9487,9487,94,29],[[[0,"--> 6\\u001b["],[-1,"0"],[1,"1;33"],[0,"m     \\u001b"]],9509,9509,25,28],[[[0,"n\\u001b["],[-1,"1;32m---->"],[1,"0m\\u001b[0;32m     "],[0," 7\\u001b"]],9801,9801,26,35],[[[0,"    7\\u001b["],[-1,"1;33"],[1,"0"],[0,"m     \\u001b"]],9825,9825,28,25],[[[0,"[0m\\n\\u001b["],[-1,"0m\\u001b["],[0,"0;32m      8"]],10064,10064,33,24],[[[0,"[1;3"],[-1,"2m<ipython-input-19-883155f528df>\\u001b[0m in \\u001b[0;36mshared_key\\u001b[1;34m(priv, pub)\\u001b[0m\\n\\u001b[0;32m      1\\u001b[0m \\u001b[1;32mdef\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      2\\u001b[0m     \\u001b[1;34m\\\"\\\"\\\"Generate a new shared encryption key from a keypair.\\\"\\\"\\\"\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 3\\u001b[1;33m     \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpriv\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      4\\u001b[0m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mAttributeError\\u001b[0m: 'str' object has no attribute 'get_ecdh_key"],[1,"1mTypeError\\u001b[0m: unsupported operand type(s) for +: 'int' and 'tuple"],[0,"'\"]}"]],10498,10498,978,81]],"time":1458371075410}
{"patch":[[[[0,":2])"],[-1,"[0]"],[0,"\\n  "]],7735,7735,11,8]],"time":1458371071366}
{"patch":[[[[0,"rypt(pri"],[-1,"v, "],[0,"cipherte"]],8164,8164,19,16],[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],8209,8209,36,35],[[[0,"nt\":"],[-1,"43,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"TypeError\",\"evalue\":\"unsupported operand type(s) for +: 'int' and 'tuple'\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mTypeError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-43-2870f10de34d>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[1;32mprint\\u001b[0m \\u001b[0mdecrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mciphertext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-41-77a7e78c6a57>\\u001b[0m in \\u001b[0;36mdecrypt\\u001b[1;34m(priv, msg)\\u001b[0m\\n\\u001b[0;32m      4\\u001b[0m     \\\"\\\"\\\"\\n\\u001b[0;32m      5\\u001b[0m     \\u001b[0mephemeral_len\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0munpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 6\\u001b[1;33m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mephemeral_len\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      7\\u001b[0m     \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mephemeral_pub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      8\\u001b[0m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0msecretkey\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mdecrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;36m2\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mephemeral_len\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mTypeError\\u001b[0m: unsupported operand type(s) for +: 'int' and 'tuple'\"]}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],8264,8264,2312,24]],"time":1458370948372}
{"patch":[[[[0,"decrypt("],[-1,"pri"],[0,"cipherte"]],8161,8161,19,16],[[[0,"t(ciphertext"],[1,", ke"],[0,")\"︡{\"metadat"]],8167,8167,24,28]],"time":1458370944356}
{"patch":[[[[0,"text, ke"],[1,"y"],[0,")\"︡{\"met"]],8175,8175,16,17]],"time":1458370940357}
{"patch":[[[[0,"]}\n\""],[-1,"print decrypt(ciphertext, key)"],[0,"\"︡{\""]],8151,8151,38,8]],"time":1458370934362}
{"patch":[[[[0,"[]}\n"],[-1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n"],[0,"\"###"]],8150,8150,113,8]],"time":1458370917363}
{"patch":[[[[0,"nt\":"],[-1,"41"],[1,"38"],[0,",\"ou"]],7968,7968,10,10],[[[0,"nt\":"],[-1,"42,\"outputs\":["],[1,"39,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"global name 'new_tag' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-39-a6b6f2226728>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      1\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 2\\u001b[1;33m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-37-e13205bb67ff>\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(pub, msg)\\u001b[0m\\n\\u001b[0;32m     75\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     76\\u001b[0m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m+=\\u001b[0m \\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 77\\u001b[1;33m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0mephemeral_pub\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mencrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-37-e13205bb67ff>\\u001b[0m in \\u001b[0;36mencrypt_02\\u001b[1;34m(data, key)\\u001b[0m\\n\\u001b[0;32m     62\\u001b[0m     \\u001b[0maes\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mAES\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mnew\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[0m__AES_KEYLEN\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mAES\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mMODE_CBC\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mivec\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     63\\u001b[0m     \\u001b[0mctxt\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0maes\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mdata\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 64\\u001b[1;33m     \\u001b[0mtag\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mnew_tag\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mivec\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mctxt\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[0m__AES_KEYLEN\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     65\\u001b[0m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0mivec\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mctxt\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mtag\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     66\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mNameError\\u001b[0m: global name 'new_tag' is not defined\"]}"],[0,"]}\n\""]],8133,8133,22,3519]],"time":1458370913402}
{"patch":[[[[0,"nt\":"],[-1,"40"],[1,"37"],[0,",\"ou"]],7145,7145,10,10]],"time":1458370909358}
{"patch":[[[[0," decrypt"],[-1,"_02"],[0,"(ciphert"]],6202,6202,19,16]],"time":1458370901366}
{"patch":[[[[0," encrypt"],[-1,"_02"],[0,"(data, k"]],5896,5896,19,16]],"time":1458370897358}
{"patch":[[[[0,"\\n\\ndef "],[1,"d"],[0,"e"],[-1,"n"],[0,"crypt"],[-1,"(data"],[1,"_02(ciphertext"],[0,", key):\\"]],5889,5889,28,37],[[[0,"ext, key):\\n    "],[-1," "],[0,"\\\"\\\"\\\"\\n     Enc"]],5915,5915,33,32],[[[0,"    "],[-1," En"],[1,"De"],[0,"crypt "],[-1,"data using AES in CBC mode. The IV is"],[1,"a ciphertext encrypted with AES in CBC mode; assumes the IV\\n    has been"],[0," pre"]],5939,5939,54,89],[[[0,"d to the"],[-1,"\\n    "],[0," ciphert"]],6033,6033,22,16],[[[0,"iphertext.\\n    "],[-1," "],[0,"\\\"\\\"\\\"\\n     dat"]],6043,6043,33,32],[[[0,"    "],[-1," data = pad_data(data)"],[1,"if len(ciphertext) <= AES.block_size:\\n        return None, False\\n    tag_start = len(ciphertext) - __TAG_LEN"],[0,"\\n    "],[-1," "],[0,"ivec = "],[-1,"gen"],[1,"ciphertext[:AES.block_size]\\n    data = ciph"],[0,"er"],[-1,"a"],[0,"te"],[-1,"_nonce()"],[1,"xt[AES.block_size:tag_start]\\n    if not verify_tag(ciphertext, key[__AES_KEYLEN:]):"],[0,"\\n     "],[1,"   return None, False\\n    "],[0,"aes "]],6067,6067,67,297],[[[0,"es = AES.new(key"],[1,"[:__AES_KEYLEN]"],[0,", AES.MODE_CBC, "]],6361,6361,32,47],[[[0,"    "],[-1," ctxt"],[1,"data"],[0," = aes."],[1,"d"],[0,"e"],[-1,"n"],[0,"cryp"]],6415,6415,22,21],[[[0,"    "],[-1," "],[0,"return "],[-1,"ivec + ctxt"],[1,"unpad_data(data), True"],[0,"\\n"],[-1," "],[0,"\\n"],[-1," "],[0,"\\ndef "],[-1,"d"],[0,"e"],[1,"n"],[0,"crypt"],[-1,"(ciphertext"],[1,"_02(data"],[0,", ke"]],6445,6445,57,62],[[[0," key):\\n    "],[-1," "],[0,"\\\"\\\"\\\"\\n    "]],6504,6504,25,24],[[[0,"    "],[-1," De"],[1,"En"],[0,"crypt "],[-1,"a ciphertext encrypted with AES in CBC mode; assumes the IV\\n     has been"],[1,"data using AES in CBC mode. The IV is"],[0," pre"]],6524,6524,91,53],[[[0,"prepended to the"],[1,"\\n   "],[0," ciphertext.\\n  "]],6574,6574,32,37],[[[0,"t.\\n    "],[-1," "],[0,"\\\"\\\"\\\"\\n"]],6605,6605,17,16],[[[0,"    "],[-1," if len(ciphertext) <= AES.block_size:\\n         raise Exception(\\\"Invalid ciphertext.\\\""],[1,"data = pad_data(data"],[0,")\\n    "],[-1," "],[0,"ivec = "],[-1,"ciphertext[:AES.block_size]\\n     ciphertext = ciphertext[AES.block_size:]"],[1,"generate_nonce()"],[0,"\\n    "],[-1," "],[0,"aes "]],6621,6621,192,64],[[[0,".new(key"],[1,"[:__AES_KEYLEN]"],[0,", AES.MO"]],6690,6690,16,31],[[[0,"    "],[-1," data"],[1,"ctxt"],[0," = aes."],[-1,"d"],[0,"e"],[1,"n"],[0,"crypt("],[-1,"ciphertext"],[1,"data)\\n    tag = new_tag(ivec+ctxt, key[__AES_KEYLEN:]"],[0,")\\n    "],[-1," "],[0,"return "],[-1,"unpad_data(data)"],[1,"ivec + ctxt + tag"],[0,"\\n\\n"]],6736,6736,69,112]],"time":1458370893389}
{"patch":[[[[0,"EN = 32\\"],[-1,"n\\"],[0,"ndef gen"]],5033,5033,18,16],[[[0,"count\":3"],[-1,"7"],[1,"4"],[0,",\"output"]],7314,7314,17,17],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}"],[0,"]}\n\"Encrypti"]],7323,7323,24,416],[[[0,"count\":3"],[-1,"8"],[1,"5"],[0,",\"output"]],8529,8529,17,17],[[[0,"count\":3"],[-1,"9"],[1,"6"],[0,",\"output"]],8694,8694,17,17],[[[0,"\":\"global name '"],[-1,"new_tag"],[1,"__AES_KEYLEN"],[0,"' is not defined"]],8765,8765,39,44],[[[0,"-input-3"],[-1,"9"],[1,"6"],[0,"-a6b6f22"]],9043,9043,17,17],[[[0,"thon-input-3"],[-1,"7-e13205bb67ff"],[1,"4-3ecdf38df595"],[0,">\\u001b[0m i"]],9552,9552,38,38],[[[0,"2m     7"],[-1,"5"],[1,"4"],[0,"\\u001b[0"]],9654,9654,17,17],[[[0,"2m     7"],[-1,"6"],[1,"5"],[0,"\\u001b[0"]],10120,10120,17,17],[[[0,"2m---> 7"],[-1,"7"],[1,"6"],[0,"\\u001b[1"]],10362,10362,17,17],[[[0,"ut-3"],[-1,"7-e13205bb67ff"],[1,"4-3ecdf38df595"],[0,">\\u0"]],10674,10674,22,22],[[[0,"    "],[-1,"62"],[1,"59"],[0,"\\u00"]],10775,10775,10,10],[[[0,"0m     \\u001b[0m"],[-1,"aes"],[1,"data"],[0,"\\u001b[0m \\u001b"]],10788,10788,35,36],[[[0,"01b[0m \\u001b[0m"],[-1,"AES"],[1,"pad_data"],[0,"\\u001b[0m\\u001b["]],10834,10834,35,40],[[[0,"b[0m\\u001b[1;33m"],[-1,"."],[1,"("],[0,"\\u001b[0m\\u001b["]],10863,10863,33,33],[[[0,"u001b[0m"],[-1,"new"],[1,"data"],[0,"\\u001b[0"]],10890,10890,19,20],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,")"],[0,"\\u001b[0m\\u001b["]],10907,10907,33,33],[[[0,"1b[0m\\u001b["],[-1,"0mkey"],[1,"1;33m"],[0,"\\u001b[0m\\u0"]],10928,10928,29,29],[[[0,"\\u001b[0m\\u001b["],[-1,"1;33m["],[1,"0m\\n\\u001b[0;32m     60\\u001b[0m     \\u001b[0mivec"],[0,"\\u001b[0m\\u001b["]],10945,10945,38,82],[[[0,"[0mivec\\u001b[0m"],[1," "],[0,"\\u001b[1;33m:\\u0"]],11004,11004,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,":"],[1,"="],[0,"\\u001b[0m\\u001b["]],11017,11017,33,33],[[[0,"[1;33m=\\u001b[0m"],[1," "],[0,"\\u001b[0m__AES_K"]],11027,11027,32,33],[[[0,"0m \\u001b[0m"],[-1,"__AES_KEYLEN"],[1,"generate_nonce"],[0,"\\u001b[0m\\u0"]],11041,11041,36,38],[[[0,"b[0m\\u001b[1;33m"],[-1,"]"],[1,"("],[0,"\\u001b[0m\\u001b["]],11072,11072,33,33],[[[0,"b[0m\\u001b[1;33m"],[-1,","],[1,")"],[0,"\\u001b[0m \\u001b"]],11094,11094,33,33],[[[0,"[1;33m)\\u001b[0m"],[-1," "],[1,"\\u001b[1;33m"],[0,"\\u001b[0mAES\\u00"]],11104,11104,33,44],[[[0,"u001b[0m"],[-1,"AES"],[0,"\\u001b[0"]],11133,11133,19,16],[[[0,"01b[0m\\u001b[0m\\"],[1,"n\\"],[0,"u001b[1;33m.\\u00"]],11135,11135,32,34],[[[0,"\\n\\u001b[1;3"],[-1,"3m.\\u001b[0m"],[1,"2m---> 61\\u001b[1;33m     "],[0,"\\u001b[0mMOD"]],11150,11150,36,50],[[[0,"u001b[0m"],[-1,"MODE_CBC"],[1,"aes"],[0,"\\u001b[0"]],11189,11189,24,19],[[[0,"b[0maes\\u001b[0m"],[1," "],[0,"\\u001b[1;33m,\\u0"]],11193,11193,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,","],[1,"="],[0,"\\u001b[0m \\u001b"]],11206,11206,33,33],[[[0,"01b[0m \\u001b[0m"],[-1,"ivec"],[1,"AES"],[0,"\\u001b[0m\\u001b["]],11226,11226,36,35],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,".\\u001b[0m\\u001b[0mnew"],[0,"\\u001b[0m\\u001b["]],11250,11250,33,54],[[[0,"b[0m\\u001b[1;33m"],[1,"("],[0,"\\u001b[0m\\u001b["]],11293,11293,32,33],[[[0,"b[0m"],[-1,"\\n"],[1,"key\\u001b[0m"],[0,"\\u001b["],[-1,"0;32m     63\\u001b[0m     \\u001b[0mctxt"],[1,"1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[0m__AES_KEYLEN\\u001b[0m\\u001b[1;33m]"],[0,"\\u00"]],11324,11324,56,107],[[[0,"[1;33m]\\u001b[0m"],[-1," "],[0,"\\u001b[1;33m=\\u0"]],11420,11420,33,32],[[[0,"b[0m\\u001b[1;33m"],[-1,"="],[1,","],[0,"\\u001b[0m \\u001b"]],11432,11432,33,33],[[[0,"01b[0m \\u001b[0m"],[-1,"aes"],[1,"AES"],[0,"\\u001b[0m\\u001b["]],11452,11452,35,35],[[[0,"001b[0m\\u001b[0m"],[-1,"encrypt"],[1,"MODE_CBC"],[0,"\\u001b[0m\\u001b["]],11495,11495,39,40],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,","],[0,"\\u001b[0m\\u001b["]],11524,11524,33,33],[[[0,"[1;33m,\\u001b[0m"],[1," "],[0,"\\u001b[0mdata\\u0"]],11534,11534,32,33],[[[0,"01b[0m \\u001b[0m"],[-1,"data"],[1,"ivec"],[0,"\\u001b[0m\\u001b["]],11544,11544,36,36],[[[0,"01b["],[-1,"1;32m---> 64"],[1,"0m\\u001b[0;32m     62"],[0,"\\u001b["],[-1,"1;33"],[1,"0"],[0,"m   "]],11630,11630,31,37],[[[0,"0m     \\u001b[0m"],[-1,"tag"],[1,"ctxt"],[0,"\\u001b[0m \\u001b"]],11662,11662,35,36],[[[0,"u001b[0m"],[-1,"new_tag"],[1,"aes"],[0,"\\u001b[0"]],11716,11716,23,19],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,"."],[0,"\\u001b[0m\\u001b["]],11732,11732,33,33],[[[0,"001b[0m\\u001b[0m"],[-1,"ivec"],[1,"encrypt"],[0,"\\u001b[0m\\u001b["]],11751,11751,36,39],[[[0,"b[0m\\u001b[1;33m"],[-1,"+"],[1,"("],[0,"\\u001b[0m\\u001b["]],11779,11779,33,33],[[[0,"001b[0m\\u001b[0m"],[-1,"ctxt"],[1,"data"],[0,"\\u001b[0m\\u001b["]],11798,11798,36,36],[[[0,"b[0m\\u001b[1;33m"],[-1,","],[1,")"],[0,"\\u001b[0m \\u001b"]],11823,11823,33,33],[[[0,"[1;33m)\\u001b[0m"],[-1," "],[1,"\\u001b[1;33m"],[0,"\\u001b[0mkey\\u00"]],11833,11833,33,44],[[[0,"b[1;33m\\u001b[0m"],[-1,"key"],[0,"\\u001b[0m\\u001b["]],11854,11854,35,32],[[[0,"0m\\u001b[0m\\"],[1,"n\\"],[0,"u001b["],[-1,"1;33m["],[1,"0;32m     63"],[0,"\\u001b[0m\\u0"]],11868,11868,36,44],[[[0,"     63\\u001b[0m"],[1,"     "],[0,"\\u001b[0m__AES_K"]],11893,11893,32,37],[[[0,"   \\u001b[0m"],[-1,"__AES_KEYLEN"],[1,"tag"],[0,"\\u001b[0m\\u0"]],11911,11911,36,27],[[[0,"b[0mtag\\u001b[0m"],[1," "],[0,"\\u001b[1;33m:\\u0"]],11919,11919,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,":"],[1,"="],[0,"\\u001b[0m\\u001b["]],11932,11932,33,33],[[[0,"3m=\\u001b[0m"],[1," "],[0,"\\u001b["],[-1,"1;33m]"],[1,"0mnew_tag"],[0,"\\u001b[0m\\u0"]],11946,11946,37,41],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"("],[0,"\\u001b[0m\\u001b["]],11980,11980,33,33],[[[0,"\\u001b[0m\\u001b["],[-1,"1;33m"],[1,"0mivec"],[0,"\\u001b[0m\\u001b["]],11997,11997,37,38],[[[0,"\\u001b[0m\\u001b["],[-1,"0m\\n"],[1,"1;33m+"],[0,"\\u001b[0m\\u001b["]],12019,12019,36,38],[[[0,"1b[0"],[-1,";32m     65"],[1,"mctxt"],[0,"\\u00"]],12054,12054,19,13],[[[0,"txt\\u001b[0m"],[-1,"     "],[0,"\\u001b[1;32m"]],12060,12060,29,24],[[[0,"0m\\u001b[1;3"],[-1,"2mreturn"],[1,"3m,"],[0,"\\u001b[0m \\u"]],12070,12070,32,27],[[[0,"01b[0m \\u001b[0m"],[-1,"ivec"],[1,"key"],[0,"\\u001b[0m \\u001b"]],12088,12088,36,35],[[[0,"b[0mkey\\u001b[0m"],[-1," "],[0,"\\u001b[1;33m+\\u0"]],12100,12100,33,32],[[[0,"b[0m\\u001b[1;33m"],[-1,"+"],[1,"["],[0,"\\u001b[0m \\u001b"]],12112,12112,33,33],[[[0,"[1;33m[\\u001b[0m"],[-1," "],[0,"\\u001b[0mctxt\\u0"]],12122,12122,33,32],[[[0,"001b[0m\\u001b[0m"],[-1,"ctxt"],[1,"__AES_KEYLEN"],[0,"\\u001b[0m \\u001b"]],12131,12131,36,44],[[[0,"_KEYLEN\\u001b[0m"],[-1," "],[0,"\\u001b[1;33m+\\u0"]],12152,12152,33,32],[[[0,";33m"],[-1,"+\\u001b[0m \\u001b[0mtag"],[1,":"],[0,"\\u00"]],12176,12176,31,9],[[[0,"b[0m\\u001b[1;33m"],[1,"]"],[0,"\\u001b[0m\\u001b["]],12186,12186,32,33],[[[0,"01b["],[-1,"0m\\n\\u001b[0;32m     66"],[1,"1;33m)"],[0,"\\u00"]],12215,12215,31,14],[[[0,"[1;33m)\\u001b[0m"],[-1," "],[0,"\\u001b[1;33m\\u00"]],12218,12218,33,32],[[[0,"l name '"],[-1,"new_tag"],[1,"__AES_KEYLEN"],[0,"' is not"]],12306,12306,23,28]],"time":1458370847010}
{"patch":[[[[0,"S \\n"],[-1,"__AES_KEYLEN = 32"],[1,"  "],[0,"\\nde"]],5019,5019,25,10]],"time":1458370842922}
{"patch":[[[[0,"nt\":"],[-1,"35"],[1,"22"],[0,",\"ou"]],8517,8517,10,10],[[[0,"count\":3"],[-1,"6"],[1,"3"],[0,",\"output"]],8679,8679,17,17],[[[0,"lobal name '"],[-1,"__AES_KEYLEN"],[1,"pad_data"],[0,"' is not def"]],8754,8754,36,32],[[[0,"-input-3"],[-1,"6"],[1,"3"],[0,"-a6b6f22"]],9024,9024,17,17],[[[0,"thon-input-3"],[-1,"4-3ecdf38df595"],[1,"2-5c029795e3ea"],[0,">\\u001b[0m i"]],9533,9533,38,38],[[[0,"    "],[-1,"7"],[0,"4"],[1,"0"],[0,"\\u00"]],9638,9638,10,10],[[[0,"    "],[-1,"75"],[1,"41"],[0,"\\u00"]],10104,10104,10,10],[[[0,"--> "],[-1,"76"],[1,"42"],[0,"\\u00"]],10346,10346,10,10],[[[0,"ut-3"],[-1,"4-3ecdf38df595"],[1,"2-5c029795e3ea"],[0,">\\u0"]],10655,10655,22,22],[[[0,"    "],[-1,"59"],[1,"23"],[0,"\\u00"]],10756,10756,10,10],[[[0,"b[0m"],[-1,"data\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpad_data\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mdata"],[1,"ciphertext"],[0,"\\u00"]],10781,10781,106,18],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"."],[0,"\\u001b[0m\\u001b["]],10800,10800,33,33],[[[0,"    "],[-1,"60"],[1,"24"],[0,"\\u00"]],10871,10871,10,10],[[[0,"   \\"],[-1,"u001b[0mivec\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_nonce\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m"],[1,"\"\\\"\\\""],[0,"\\n\\u"]],10888,10888,159,13],[[[0,"--> "],[-1,"61"],[1,"25"],[0,"\\u00"]],10912,10912,10,10],[[[0,"3m     \\u001b[0m"],[-1,"aes"],[1,"data"],[0,"\\u001b[0m \\u001b"]],10928,10928,35,36],[[[0,"b[0m"],[-1,"AES\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mnew"],[1,"pad_data"],[0,"\\u00"]],10986,10986,54,16],[[[0,"001b[0m\\u001b[0m"],[-1,"key"],[1,"data"],[0,"\\u001b[0m\\u001b["]],11022,11022,35,36],[[[0,"b[0m\\u001b[1;33m"],[-1,"["],[1,")"],[0,"\\u001b[0m\\u001b["]],11047,11047,33,33],[[[0,"b[0m\\u001b[1;33m"],[-1,":"],[0,"\\u001b[0m\\u001b["]],11069,11069,33,32],[[[0,"[0m\\u001b[0m"],[-1,"__AES_KEYLEN"],[1,"\\n"],[0,"\\u001b[0m\\u0"]],11091,11091,36,26],[[[0,"01b["],[-1,"1;33m]\\u001b[0m\\u001b[1;33m,"],[1,"0;32m     26"],[0,"\\u00"]],11117,11117,36,20],[[[0,"    26\\u001b[0m "],[1,"    "],[0,"\\u001b[0mAES\\u00"]],11127,11127,32,36],[[[0,"u001b[0m"],[-1,"AES"],[1,"ivec"],[0,"\\u001b[0"]],11148,11148,19,20],[[[0,"[0mivec\\u001b[0m"],[1," "],[0,"\\u001b[1;33m.\\u0"]],11153,11153,32,33],[[[0,"[0m \\u001b[1;33m"],[-1,"."],[1,"="],[0,"\\u001b[0m\\u001b["]],11166,11166,33,33],[[[0,"[1;33m=\\u001b[0m"],[1," "],[0,"\\u001b[0mMODE_CB"]],11176,11176,32,33],[[[0,"u001b[0m"],[-1,"MODE_CBC"],[1,"generate_nonce"],[0,"\\u001b[0"]],11194,11194,24,30],[[[0,";33m"],[-1,",\\u001b[0m \\u001b[0mivec"],[1,"("],[0,"\\u00"]],11233,11233,32,9],[[[0,"[0m\\n\\u001b["],[-1,"0m\\u001b["],[0,"0;32m     62"]],11296,11296,33,24],[[[0,"    "],[-1,"6"],[0,"2"],[1,"7"],[0,"\\u00"]],11314,11314,10,10],[[[0,"0m     \\u001b[0m"],[-1,"ctxt"],[1,"aes"],[0,"\\u001b[0m \\u001b"]],11327,11327,36,35],[[[0,"01b[0m \\u001b[0m"],[-1,"aes"],[1,"AES"],[0,"\\u001b[0m\\u001b["]],11372,11372,35,35],[[[0,"001b[0m\\u001b[0m"],[-1,"encrypt"],[1,"new"],[0,"\\u001b[0m\\u001b["]],11415,11415,39,35],[[[0,"b[0m"],[-1,"data\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     63\\u001b[0m     \\u001b[0mtag"],[1,"key\\u001b[0m\\u001b[1;33m["],[0,"\\u00"]],11470,11470,120,33],[[[0,"[1;33m[\\u001b[0m"],[-1," "],[0,"\\u001b[1;33m=\\u0"]],11492,11492,33,32],[[[0,"b[0m\\u001b[1;33m"],[-1,"="],[1,":"],[0,"\\u001b[0m \\u001b"]],11504,11504,33,33],[[[0,"[1;33m:\\u001b[0m"],[-1," "],[0,"\\u001b[0mnew_tag"]],11514,11514,33,32],[[[0,"u001b[0m"],[-1,"new_tag"],[1,"__AES_KEYLEN"],[0,"\\u001b[0"]],11531,11531,23,28],[[[0,";33m"],[-1,"(\\u001b[0m\\u001b[0mivec\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mctxt"],[1,"]"],[0,"\\u00"]],11568,11568,75,9],[[[0,"01b[0m \\u001b[0m"],[-1,"key"],[1,"AES"],[0,"\\u001b[0m\\u001b["]],11598,11598,35,35],[[[0,"b[0m\\u001b[1;33m"],[-1,"["],[1,"."],[0,"\\u001b[0m\\u001b["]],11622,11622,33,33],[[[0,"[0m\\u001b[0m"],[-1,"__AES_KEYLEN"],[1,"MODE_CBC"],[0,"\\u001b[0m\\u0"]],11645,11645,36,32],[[[0,"b[0m\\u001b[1;33m"],[-1,":"],[1,","],[0,"\\u001b[0m\\u001b["]],11670,11670,33,33],[[[0,"3m,\\u001b[0m"],[1," "],[0,"\\u001b["],[-1,"1;33m]"],[1,"0mivec"],[0,"\\u001b[0m\\u0"]],11684,11684,37,38],[[[0,"l name '"],[-1,"__AES_KEYLEN"],[1,"pad_data"],[0,"' is not"]],11813,11813,28,24]],"time":1458370824411}
{"patch":[[[[0,"count\":3"],[-1,"4"],[1,"2"],[0,",\"output"]],7299,7299,17,17],[[[0,"s\":["],[-1,"{\"output_type\":\"stream\",\"text\":\"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/Crypto/Util/number.py:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\n  _warn(\\\"Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\\\", PowmInsecureWarning)\\n\",\"name\":\"stderr\"}"],[0,"]}\n\""]],7316,7316,400,8]],"time":1458370820364}
{"patch":[[[[0," RNG"],[-1,"\\nimport Crypto.Cipher.AES as AES "],[0,"\\n  "]],4983,4983,42,8]],"time":1458370816404}
{"patch":[[[[0,"def "],[-1,"pad_data(data):\\n    \\\"\\\"\\\"pad_data pads out the data to an AES block length.\\\"\\\"\\\"\\n    # return data if no padding is required\\n    if len(data) % 16 == 0:\\n        return data\\n\\n    # subtract one byte that should be the 0x80\\n    # if 0 bytes of padding are required, it means only\\n    # a single \\\\x80 is required.\\n\\n    padding_required = 15 - (len(data) % 16)\\n\\n    data = '%s\\\\x80' % data\\n    data = '%s%s' % (data, '\\\\x00' * padding_required)\\n\\n    return data\\n\\ndef unpad_data(data):\\n    \\\"\\\"\\\"unpad_data removes padding from the data.\\\"\\\"\\\"\\n    if not data:\\n        return data\\n\\n    data = data.rstrip('\\\\x00')\\n    if data[-1] == '\\\\x80':\\n        return data[:-1]\\n    else:\\n        return data\\n\\ndef "],[0,"decr"]],5114,5114,736,8]],"time":1458370772386}
{"patch":[[[[0,"k_size)\\"],[-1,"n\\"],[0,"ndef dec"]],5103,5103,18,16]],"time":1458370759358}
{"patch":[[[[0,"ct\\n"],[-1,"import Crypto.Random.OSRNG.posix as RNG\\n  \\ndef generate_nonce():\\n    \\\"\\\"\\\"Generate a random number used once.\\\"\\\"\\\"\\n    return RNG.new().read(AES.block_size)"],[0,"\\nde"]],4944,4944,170,8]],"time":1458370755366}
{"patch":[[[[0,"count\":3"],[-1,"3"],[1,"1"],[0,",\"output"]],7361,7361,17,17],[[[0,"ename\":\""],[-1,"Nam"],[1,"Typ"],[0,"eError\","]],7406,7406,19,19],[[[0,"e\":\""],[-1,"global name 'pad_data' is not defined"],[1,"unsupported operand type(s) for +=: 'instance' and 'str'"],[0,"\",\"t"]],7431,7431,45,64],[[[0,"m\",\"\\u001b[1;31m"],[-1,"Nam"],[1,"Typ"],[0,"eError\\u001b[0m "]],7602,7602,35,35],[[[0,"-input-3"],[-1,"3"],[1,"1"],[0,"-a6b6f22"]],7725,7725,17,17],[[[0,"thon-input-3"],[-1,"2-5c029795e3e"],[1,"0-27b8033d944"],[0,"a>\\u001b[0m "]],8234,8234,37,37],[[[0,"    "],[-1,"40"],[1,"39"],[0,"\\u00"]],8339,8339,10,10],[[[0,"   \\u001b[0m"],[-1,"ephemeral_pub"],[1,"key"],[0,"\\u001b[0m \\u"]],8356,8356,37,27],[[[0,"[0ms"],[-1,"truct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mlen"],[1,"hared_key"],[0,"\\u00"]],8410,8410,148,17],[[[0,"b[0m\\u001b[1;33m"],[-1,"."],[1,","],[0,"\\u001b[0m\\u001b["]],8477,8477,33,33],[[[0,"[1;33m,\\u001b[0m"],[1," "],[0,"\\u001b[0mget_pub"]],8487,8487,32,33],[[[0,"b[0m"],[-1,"get_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)"],[1,"pub"],[0,"\\u00"]],8509,8509,84,11],[[[0,"2m     4"],[-1,"1"],[1,"0"],[0,"\\u001b[0"]],8589,8589,17,17],[[[0,"1b[1;33m"],[-1,"+"],[0,"=\\u001b["]],8648,8648,17,16],[[[0,"0m \\u001b[0m"],[-1,"ephemeral"],[1,"struct"],[0,"\\u001b[0m\\u0"]],8664,8664,33,30],[[[0,"u001b[0m"],[-1,"get_pubkey"],[1,"pack"],[0,"\\u001b[0"]],8714,8714,26,20],[[[0,"01b[0m\\u001b[1;3"],[-1,"3m)"],[1,"4m'>H'"],[0,"\\u001b[0m\\u001b["]],8751,8751,35,38],[[[0,"b[0m\\u001b[1;33m"],[1,","],[0,"\\u001b[0m\\u001b["]],8778,8778,32,33],[[[0,"[1;33m,\\u001b[0m"],[1," "],[0,"\\u001b[0m\\n\\u001"]],8788,8788,32,33],[[[0,"b[0m"],[-1,"\\"],[1,"le"],[0,"n\\u001b["],[-1,"1;32m---> 42\\u001b[1;33m     \\u001b[1;32mreturn"],[1,"0m\\u001b[1;33m("],[0,"\\u00"]],8810,8810,64,33],[[[0,"[1;33m(\\u001b[0m"],[-1," "],[0,"\\u001b[0mephemer"]],8832,8832,33,32],[[[0,"001b[0mephemeral"],[-1,"_pub"],[0,"\\u001b[0m\\u001b["]],8850,8850,36,32],[[[0,"1b[1;33m"],[-1,"+"],[1,"."],[0,"\\u001b[0"]],8879,8879,17,17],[[[0,"b[0m"],[-1,"encrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0m"],[1,"get_pub"],[0,"key\\"]],8902,8902,102,15],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"("],[0,"\\u001b[0m\\u001b["]],8921,8921,33,33],[[[0,";33m"],[-1,"\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-32-5c029795e3ea>\\u001b[0m in \\u001b[0;36mencrypt_02\\u001b[1;34m(data, key)\\u001b[0m\\n\\u001b[0;32m     23\\u001b[0m     \\u001b[0mciphertext"],[1,")\\u001b[0m\\u001b[1;33m)"],[0,"\\u00"]],8955,8955,204,31],[[[0,"b[0m\\u001b[1;33m"],[-1,"."],[1,")"],[0,"\\u001b[0m\\u001b["]],8987,8987,33,33],[[[0,"01b["],[-1,"0;32m     24\\u001b[0m     \\\"\\\"\\\"\\n\\u001b["],[0,"1;32"]],9048,9048,49,8],[[[0,"32m---> "],[-1,"25"],[1,"41"],[0,"\\u001b[1"]],9054,9054,18,18],[[[0,"3m     \\u001b[0m"],[-1,"data"],[1,"ephemeral"],[0,"\\u001b[0m \\u001b"]],9074,9074,36,41],[[[0,"[0m \\u001b[1;33m"],[1,"+"],[0,"=\\u001b[0m \\u001"]],9105,9105,32,33],[[[0,"b[0m"],[-1,"pad_data\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mdata"],[1,"ephemeral"],[0,"\\u00"]],9138,9138,60,17],[[[0,"b[0m\\u001b[1;33m"],[-1,")"],[1,"."],[0,"\\u001b[0m\\u001b["]],9156,9156,33,33],[[[0,"01b["],[-1,"1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     26\\u001b[0m     \\u001b[0mivec\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_nonce"],[1,"0mget_pubkey"],[0,"\\u00"]],9185,9185,144,20],[[[0,"001b[0m\\n\\u001b["],[1,"0m\\u001b["],[0,"0;32m     27\\u00"]],9277,9277,32,41],[[[0,"32m     "],[1,"4"],[0,"2"],[-1,"7"],[0,"\\u001b[0"]],9304,9304,18,18],[[[0,"01b["],[-1,"0maes\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mAES\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mnew"],[1,"1;32mreturn\\u001b[0m \\u001b[0mephemeral_pub"],[0,"\\u00"]],9331,9331,101,51],[[[0,"b[0m\\u001b[1;33m"],[-1,"("],[1,"+"],[0,"\\u001b[0m\\u001b["]],9383,9383,33,33],[[[0,"b[0m"],[-1,"key\\u001b[0m\\u001b[1;33m[\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[0m__AES_KEYLEN\\u001b[0m\\u001b[1;33m]\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mAES\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mMODE_CBC"],[1,"encrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg"],[0,"\\u00"]],9414,9414,199,61],[[[0,"u001b[0m"],[-1,"ivec"],[1,"key"],[0,"\\u001b[0"]],9504,9504,20,19],[[[0,";31m"],[-1,"Nam"],[1,"Typ"],[0,"eErr"]],9589,9589,11,11],[[[0,"0m: "],[-1,"global name 'pad_data' is not defined"],[1,"unsupported operand type(s) for +=: 'instance' and 'str'"],[0,"\"]}]"]],9609,9609,45,64]],"time":1458370705509}
{"patch":[[[[0,"count\":3"],[-1,"2"],[1,"0"],[0,",\"output"]],6373,6373,17,17]],"time":1458370701332}
{"patch":[[[[0,"phemeral"],[-1,"_pub"],[0," += ephe"]],6209,6209,20,16]],"time":1458370697390}
{"patch":[[[[0,"_count\":"],[-1,"31"],[1,"29"],[0,",\"output"]],7356,7356,18,18],[[[0,"ename\":\""],[-1,"Typ"],[1,"Attribut"],[0,"eError\","]],7402,7402,19,24],[[[0,"e\":\""],[-1,"unsupported operand type(s) for +=: 'instance' and 'str"],[1,"ECC instance has no attribute 'get_public_key"],[0,"'\",\""]],7432,7432,63,53],[[[0,"m\",\"\\u001b[1;31m"],[-1,"Typ"],[1,"Attribut"],[0,"eError\\u001b[0m "]],7593,7593,35,40],[[[0,"        "],[-1,"     "],[0,"Tracebac"]],7652,7652,21,16],[[[0,"n-input-"],[-1,"31"],[1,"29"],[0,"-a6b6f22"]],7715,7715,18,18],[[[0,"put-"],[-1,"30-27b8033d944a"],[1,"28-efaf6a1293dd"],[0,">\\u0"]],8232,8232,23,23],[[[0,"\\u001b[0mget_pub"],[1,"lic_"],[0,"key\\u001b[0m\\u00"]],9173,9173,32,36],[[[0,";31m"],[-1,"Typ"],[1,"Attribut"],[0,"eErr"]],9584,9584,11,16],[[[0,"0m: "],[-1,"unsupported operand type(s) for +=: 'instance' and 'str"],[1,"ECC instance has no attribute 'get_public_key"],[0,"'\"]}"]],9609,9609,63,53]],"time":1458370611329}
{"patch":[[[[0,"nt\":"],[-1,"30"],[1,"28"],[0,",\"ou"]],6372,6372,10,10]],"time":1458370607358}
{"patch":[[[[0,"eral.get_pub"],[1,"l"],[0,"key()\\n    r"]],6226,6226,24,25]],"time":1458370601363}
{"patch":[[[[0,"get_publ"],[1,"ic_"],[0,"key()\\n "]],6231,6231,16,19]],"time":1458370597366}
{"patch":[[[[0,"count\":2"],[-1,"8"],[1,"6"],[0,",\"output"]],6373,6373,17,17],[[[0,"count\":2"],[-1,"9"],[1,"7"],[0,",\"output"]],7361,7361,17,17],[[[0," 'get_public"],[-1,"_"],[0,"key'\",\"trace"]],7469,7469,25,24],[[[0,"-input-2"],[-1,"9"],[1,"7"],[0,"-a6b6f22"]],7719,7719,17,17],[[[0,"ut-2"],[-1,"8-efaf6a1293dd"],[1,"6-dab1cf76666e"],[0,">\\u0"]],8236,8236,22,22],[[[0,"32m     "],[1,"38\\u001b[0m     \\u001b[0mephemeral\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     "],[0,"39\\u001b"]],8329,8329,16,206],[[[0,"n\\u001b["],[-1,"0"],[1,"1"],[0,";32m"],[-1,"    "],[1,"--->"],[0," 40\\u001"]],8762,8762,25,25],[[[0,"-> 40\\u001b["],[-1,"0"],[1,"1;33"],[0,"m     \\u001b"]],8777,8777,25,28],[[[0,"mget_pub"],[1,"lic"],[0,"key\\u001"]],9092,9092,16,19],[[[0,"n\\u001b["],[-1,"1;32m--->"],[1,"0m\\u001b[0;32m    "],[0," 41\\u001"]],9234,9234,25,34],[[[0,"   41\\u001b["],[-1,"1;33"],[1,"0"],[0,"m     \\u001b"]],9258,9258,28,25],[[[0,"[0m\\n\\u001b["],[-1,"0m\\u001b["],[0,"0;32m     42"]],9481,9481,33,24],[[[0,"t_public"],[-1,"_"],[0,"key'\"]}]"]],9842,9842,17,16]],"time":1458370561342}
{"patch":[[[[0,"eral.get_pub"],[1,"lic"],[0,"key()))\\n   "]],6183,6183,24,27]],"time":1458370557389}
{"patch":[[[[0,"count\":2"],[-1,"7"],[1,"5"],[0,",\"output"]],7364,7364,17,17],[[[0," 'get_public"],[1,"_"],[0,"key'\",\"trace"]],7472,7472,24,25],[[[0,"-input-2"],[-1,"7"],[1,"5"],[0,"-a6b6f22"]],7723,7723,17,17],[[[0,"ut-2"],[-1,"6-dab1cf76666e"],[1,"0-7a9f5482d9d6"],[0,">\\u0"]],8240,8240,22,22],[[[0,"t_public"],[1,"_"],[0,"key\\u001"]],9099,9099,16,17],[[[0,"t_public"],[1,"_"],[0,"key'\"]}]"]],9847,9847,16,17]],"time":1458370543383}
{"patch":[[[[0,"count\":2"],[-1,"6"],[1,"0"],[0,",\"output"]],6376,6376,17,17]],"time":1458370539390}
{"patch":[[[[0,"t_public"],[1,"_"],[0,"key()))\\"]],6190,6190,16,17]],"time":1458370531362}
{"patch":[[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],7312,7312,36,35],[[[0,"nt\":"],[-1,"25,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"AttributeError\",\"evalue\":\"ECC instance has no attribute 'get_public_key'\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mAttributeError\\u001b[0m                            Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-25-a6b6f2226728>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      1\\u001b[0m \\u001b[0mplaintext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[1;34m'AG is god'\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m----> 2\\u001b[1;33m \\u001b[0mciphertext\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mplaintext\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m<ipython-input-20-7a9f5482d9d6>\\u001b[0m in \\u001b[0;36mencrypt\\u001b[1;34m(pub, msg)\\u001b[0m\\n\\u001b[0;32m     38\\u001b[0m     \\u001b[0mephemeral\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mgenerate_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     39\\u001b[0m     \\u001b[0mkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mshared_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 40\\u001b[1;33m     \\u001b[0mephemeral_pub\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpack\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m'>H'\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_public_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     41\\u001b[0m     \\u001b[0mephemeral\\u001b[0m \\u001b[1;33m+=\\u001b[0m \\u001b[0mephemeral\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_public_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     42\\u001b[0m     \\u001b[1;32mreturn\\u001b[0m \\u001b[0mephemeral_pub\\u001b[0m\\u001b[1;33m+\\u001b[0m\\u001b[0mencrypt_02\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mmsg\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mAttributeError\\u001b[0m: ECC instance has no attribute 'get_public_key'\"]}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],7367,7367,2500,24]],"time":1458370478357}
{"patch":[[[[0,"encrypt("],[-1,"pub, "],[0,"plaintex"]],7263,7263,21,16]],"time":1458370474404}
{"patch":[[[[0,"laintext"],[1,", "],[0,")\"︡{\"met"]],7272,7272,16,18]],"time":1458370470404}
{"patch":[[[[0,"intext, "],[1,"key"],[0,")\"︡{\"met"]],7274,7274,16,19]],"time":1458370466403}
{"patch":[[[[0,"s\":[]}\n\""],[1,"keyin = 'star'\\n"],[0,"plaintex"]],7217,7217,16,32]],"time":1458370462362}
{"patch":[[[[0,"_count\":"],[-1,"2"],[0,"4,\"outpu"]],1859,1859,17,16]],"time":1458370458361}
{"patch":[[[[0,"_count\":"],[-1,"2"],[0,"3,\"outpu"]],1733,1733,17,16]],"time":1458370454368}
{"patch":[[[[0,"ecrypt(p"],[-1,"riv"],[0,", msg):\\"]],6818,6818,19,16],[[[0,"count\":2"],[-1,"2"],[1,"1"],[0,",\"output"]],7195,7195,17,17]],"time":1458370436360}
{"patch":[[[[0,"ecrypt(p"],[1,"ub"],[0,", msg):\\"]],6818,6818,16,18]],"time":1458370432367}
{"patch":[[[[0,"is god'\\"],[1,"nsalt, key = password_key(keyin)\\"],[0,"nciphert"]],7254,7254,16,49]],"time":1458370382360}
{"patch":[[[[0,"]}\n\""],[-1,"keyin = 'star'\\nplaintext = 'AG is god'\\nsalt, key = password_key(keyin)\\nciphertext = encrypt(plaintext, key)"],[0,"\"︡{\""]],7218,7218,118,8]],"time":1458370314405}
{"patch":[[[[0,"[]}\n"],[-1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n"],[0,"\"###"]],7217,7217,113,8]],"time":1458370305377}
{"patch":[[[[0,":[]}\n\"##"],[-1,"# "],[0,"Key Exch"]],7216,7216,18,16]],"time":1458370293366}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"##"],[0,"Key Exch"]],7214,7214,18,16]],"time":1458370289367}
{"patch":[[[[0,"_count\":"],[-1,"21"],[1,"null"],[0,",\"output"]],7196,7196,18,20]],"time":1458370281379}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"19"],[0,",\"outputs\":[]}\n\""]],7188,7188,36,34]],"time":1458370277407}
{"patch":[[[[0,"ey.decrypt_0"],[-1,"2"],[0,"(msg[2+ephem"]],7078,7078,25,24]],"time":1458370267362}
{"patch":[[[[0,".decrypt"],[-1,"_0"],[0,"(msg[2+e"]],7080,7080,18,16]],"time":1458370263366}
{"patch":[[[[0,"nt\":"],[-1,"20,\"outputs\":["],[1,"18,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"ImportError\",\"evalue\":\"No module named secretkey\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mImportError\\u001b[0m                               Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-18-84786f8f4e33>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[1;32mimport\\u001b[0m \\u001b[0msecretkey\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[1;32mimport\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      4\\u001b[0m \\u001b[1;32mdef\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      5\\u001b[0m     \\\"\\\"\\\"\\n\",\"\\u001b[1;31mImportError\\u001b[0m: No module named secretkey\"]}"],[0,"]}\n\""]],6378,6378,22,1067]],"time":1458370249344}
{"patch":[[[[0,"ecution_count\":1"],[-1,"9"],[1,"8"],[0,",\"outputs\":[]}\n\""]],4361,4361,33,33]],"time":1458370245378}
{"patch":[[[[0,"h_key(pub)\\n    "],[1,"shared_key = shared_key[:32] + SHA512.new(shared_key[32:]).digest()\\n    "],[0,"return shared_ke"]],4258,4258,32,105]],"time":1458370241370}
{"patch":[[[[0,"xecution_count\":"],[-1,"18"],[1,"null"],[0,",\"outputs\":[]}\n\""]],4433,4433,34,36]],"time":1458370199363}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"17"],[0,",\"outputs\":[]}\n\""]],4433,4433,36,34]],"time":1458370195362}
{"patch":[[[[0,"2] + SHA"],[-1,"512"],[1,"384"],[0,".new(sha"]],4300,4300,19,19]],"time":1458370187367}
{"patch":[[[[0,"encrypt_"],[-1,"02"],[0,"(msg, ke"]],6349,6349,18,16]],"time":1458370171395}
{"patch":[[[[0,"ral_pub+"],[1,"secretkey."],[0,"encrypt"],[-1,"_"],[0,"(msg, ke"]],6341,6341,24,33]],"time":1458370167388}
{"patch":[[[[0,"ncrypt_0"],[-1,"2"],[0,"(data, k"]],5617,5617,17,16]],"time":1458370163379}
{"patch":[[[[0,"ypt_"],[-1,"02"],[0,"(cip"]],5029,5029,10,8],[[[0,"rypt"],[-1,"_0"],[0,"(dat"]],5617,5617,10,8]],"time":1458370159375}
{"patch":[[[[0," decrypt"],[-1,"_"],[0,"(ciphert"]],5024,5024,17,16]],"time":1458370155375}
{"patch":[[[[0,"import s"],[-1,"truct"],[1,"ecretkey"],[0,"\\n\\ndef "]],5004,5004,21,24]],"time":1458370136418}
{"patch":[[[[0,"cretkey\\"],[1,"nimport struct\\"],[0,"n\\ndef d"]],5013,5013,16,31]],"time":1458370132543}
{"patch":[[[[0,"t\\n\\"],[-1,"ndef decrypt(ciphertext, key):\\n    \\\"\\\"\\\"\\n    Decrypt a ciphertext encrypted with AES in CBC mode; assumes the IV\\n    has been prepended to the ciphertext.\\n    \\\"\\\"\\\"\\n    if len(ciphertext) <= AES.block_size:\\n        return None, False\\n    tag_start = len(ciphertext) - __TAG_LEN\\n    ivec = ciphertext[:AES.block_size]\\n    data = ciphertext[AES.block_size:tag_start]\\n    if not verify_tag(ciphertext, key[__AES_KEYLEN:]):\\n        return None, False\\n    aes = AES.new(key[:__AES_KEYLEN], AES.MODE_CBC, ivec)\\n    data = aes.decrypt(data)\\n    return unpad_data(data), True\\n\\n\\ndef encrypt(data, key):\\n    \\\"\\\"\\\"\\n    Encrypt data using AES in CBC mode. The IV is prepended to the\\n    ciphertext.\\n    \\\"\\\"\\\"\\n    data = pad_data(data)\\n    ivec = generate_nonce()\\n    aes = AES.new(key[:__AES_KEYLEN], AES.MODE_CBC, ivec)\\n    ctxt = aes.encrypt(data)\\n    tag = new_tag(ivec+ctxt, key[__AES_KEYLEN:])\\n    return ivec + ctxt + tag\\n\\"],[0,"n\\nd"]],5034,5034,957,8]],"time":1458370128405}
{"patch":[[[[0,"truct\\n\\"],[-1,"n\\"],[0,"ndef enc"]],5030,5030,18,16]],"time":1458370124382}
{"patch":[[[[0,"_key()\\n    "],[1,"ctx = pyelliptic.Cipher(\\\"secretkey\\\", iv, 1, ciphername='aes-256-cfb')\\n    ciphertext = ctx.update('test1')\\n    ciphertext += ctx.final()\\n    "],[0,"return ephem"]],5377,5377,24,170]],"time":1458369864367}
{"patch":[[[[0,"e('test1')\\n"],[-1,"    "],[1,"\\n"],[0,"ciphertext +"]],5488,5488,28,26]],"time":1458369817383}
{"patch":[[[[0,"est1')\\n"],[1,"ciphertext += ctx.update('test2')"],[0,"\\ncipher"]],5492,5492,16,49]],"time":1458369813382}
{"patch":[[[[0,"    "],[-1,"ciphertext = ctx.update('test1')\\nciphertext += ctx.update('test2')\\nciphertext += ctx.final()\\n    "],[0,"retu"]],5462,5462,108,8]],"time":1458369809386}
{"patch":[[[[0,"    "],[-1,"ctx = pyelliptic.Cipher(\\\"secretkey\\\", iv, 1, ciphername='aes-256-cfb')"],[0,"\\n  "]],5385,5385,79,8]],"time":1458369779373}
{"patch":[[[[0,"()\\n    "],[-1,"\\n    "],[0,"return e"]],5381,5381,22,16]],"time":1458369775378}
{"patch":[[[[0," key is "],[-1,"32"],[1,"64"],[0," bytes; "]],3851,3851,18,18]],"time":1458369627934}
{"patch":[[[[0,"xecution_count\":"],[-1,"17"],[1,"null"],[0,",\"outputs\":[{\"ou"]],3713,3713,34,36],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":17}"],[0,"]}\n\""]],3741,3741,102,8]],"time":1458369605387}
{"patch":[[[[0,"_count\":"],[-1,"null,\"outputs\":["],[1,"16,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"UnboundLocalError\",\"evalue\":\"local variable 'own_priv_key' referenced before assignment\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m                         Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-16-6b238111d62e>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mCurve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mget_ecdh_key\\u001b[1;34m(self, pubkey, format)\\u001b[0m\\n\\u001b[0;32m    269\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m    270\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mformat\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 271\\u001b[1;33m         \\u001b[1;32mreturn\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    272\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    273\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key\\u001b[1;34m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    323\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_POINT_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    324\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 325\\u001b[1;33m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_priv_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    326\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    327\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mcheck_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m: local variable 'own_priv_key' referenced before assignment\"]}"],[0,"]}\n\"Our "]],3721,3721,32,3559]],"time":1458369601360}
{"patch":[[[[0,"d_key = "],[-1,"key"],[1,"Curve"],[0,".get_ecd"]],3597,3597,19,21]],"time":1458369597382}
{"patch":[[[[0,"count\":1"],[-1,"6"],[1,"5"],[0,",\"output"]],3724,3724,17,17],[[[0,"-input-1"],[-1,"6"],[1,"5"],[0,"-6b23811"]],4098,4098,17,17]],"time":1458369551379}
{"patch":[[[[0,"\"markdown\"}\n"],[1,"\"Curve = pyelliptic.ECC(curve='secp521r1', pubkey=pub)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":12,\"outputs\":[]}\n"],[0,"\"### Signing"]],1983,1983,24,181]],"time":1458369528385}
{"patch":[[[[0,"kdown\"}\n"],[1,"\"pyelliptic.ECC(privkey=priv)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":7,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f1c7c6847a0>\"},\"metadata\":{},\"execution_count\":7}]}\n"],[0,"\"Curve ="]],1987,1987,16,285]],"time":1458369524372}
{"patch":[[[[0,"count\":1"],[-1,"5"],[1,"1"],[0,",\"output"]],4150,4150,17,17],[[[0,"\":\"e"],[-1,"rror\",\"ename\":\"UnboundLocalError\",\"evalue\":\"local variable 'own_priv_key' referenced before assignment\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m                         Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-15-6b238111d62e>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mCurve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mget_ecdh_key\\u001b[1;34m(self, pubkey, format)\\u001b[0m\\n\\u001b[0;32m    269\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m    270\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mformat\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 271\\u001b[1;33m         \\u001b[1;32mreturn\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    272\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    273\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key\\u001b[1;34m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    323\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_POINT_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    324\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 325\\u001b[1;33m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_priv_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    326\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    327\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mcheck_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m: local variable 'own_priv_key' referenced before assignment\"]"],[1,"xecute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":11"],[0,"}]}\n"]],4184,4184,3519,84]],"time":1458369436454}
{"patch":[[[[0,"_count\":"],[-1,"12"],[1,"8"],[0,",\"output"]],2396,2396,18,17],[[[0,"nt\":"],[-1,"13"],[1,"9"],[0,",\"ou"]],2919,2919,10,9],[[[0,"count\":1"],[-1,"4"],[1,"0"],[0,",\"output"]],3423,3423,17,17]],"time":1458369432384}
{"patch":[[[[0,"bkey=pub"],[1,"key="],[0,")\"︡{\"met"]],2309,2309,16,20]],"time":1458369428379}
{"patch":[[[[0,"521r1', "],[-1,"pubkey="],[0,"pubkey=)"]],2299,2299,23,16]],"time":1458369424384}
{"patch":[[[[0,"521r1', "],[-1,"pubkey="],[0,")\"︡{\"met"]],2299,2299,23,16]],"time":1458369419398}
{"patch":[[[[0,"cp521r1'"],[-1,", "],[0,")\"︡{\"met"]],2297,2297,18,16]],"time":1458369415399}
{"patch":[[[[0,"_count\":"],[-1,"11"],[1,"6"],[0,",\"output"]],4135,4135,18,17],[[[0,"\":\"e"],[-1,"xecute_result\",\"data\":{\"text/plain\":\"32\"},\"metadata\":{},\"execution_count\":11"],[1,"rror\",\"ename\":\"UnboundLocalError\",\"evalue\":\"local variable 'own_key' referenced before assignment\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m                         Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-6-6b238111d62e>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mCurve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mget_ecdh_key\\u001b[1;34m(self, pubkey, format)\\u001b[0m\\n\\u001b[0;32m    269\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m    270\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mformat\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 271\\u001b[1;33m         \\u001b[1;32mreturn\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    272\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    273\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key\\u001b[1;34m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    322\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    323\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_POINT_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 324\\u001b[1;33m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    325\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_priv_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    326\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m: local variable 'own_key' referenced before assignment\"]"],[0,"}]}\n"]],4169,4169,84,3430]],"time":1458369254430}
{"patch":[[[[0,"_count\":"],[-1,"7"],[1,"null"],[0,",\"output"]],2102,2102,17,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f1c7c6847a0>\"},\"metadata\":{},\"execution_count\":7}"],[0,"]}\n\""]],2122,2122,146,8],[[[0,"_count\":"],[-1,"8"],[1,"24"],[0,",\"output"]],2249,2249,17,18],[[[0,"_count\":"],[-1,"9"],[1,"30"],[0,",\"output"]],2769,2769,17,18],[[[0,"nt\":"],[1,"3"],[0,"1"],[-1,"0"],[0,",\"ou"]],3281,3281,10,10]],"time":1458369250427}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"5"],[0,",\"outputs\":[]}\n\""]],2094,2094,36,33],[[[0,"Curv"],[-1,"e = "],[0,"pyel"]],2127,2127,12,8]],"time":1458369246388}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"Curv"],[1,"# "],[0,"pyellipt"]],2119,2119,20,18],[[[0,"tic.ECC("],[-1,"curve='secp521r1'"],[1,"pubkey=pub"],[0,")\"︡{\"met"]],2136,2136,33,26]],"time":1458369242405}
{"patch":[[[[0,"down\"}\n\""],[1,"Curve = "],[0,"pyellipt"]],1988,1988,16,24]],"time":1458369238386}
{"patch":[[[[0,"nt\":"],[-1,"6,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"UnboundLocalError\",\"evalue\":\"local variable 'own_key' referenced before assignment\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m                         Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-6-6b238111d62e>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mCurve\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mget_ecdh_key\\u001b[1;34m(self, pubkey, format)\\u001b[0m\\n\\u001b[0;32m    269\\u001b[0m         \\\"\\\"\\\"\\n\\u001b[0;32m    270\\u001b[0m         \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_pubkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mformat\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 271\\u001b[1;33m         \\u001b[1;32mreturn\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    272\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    273\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0mraw_get_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_get_ecdh_key\\u001b[1;34m(self, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    322\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key_y\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    323\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_POINT_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mother_pub_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 324\\u001b[1;33m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    325\\u001b[0m             \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mBN_free\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mown_priv_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    326\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mUnboundLocalError\\u001b[0m: local variable 'own_key' referenced before assignment\"]}"],[1,"null,\"outputs\":["],[0,"]}\n\""]],3998,3998,3461,24]],"time":1458369195357}
{"patch":[[[[0,"d_key = "],[-1,"Curve"],[1,"priv"],[0,".get_ecd"]],3868,3868,21,20]],"time":1458369191383}
{"patch":[[[[0,"kdown\"}\n"],[1,"\"type(pub)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":15,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":15}]}\n"],[0,"\"shared_"]],3854,3854,16,224]],"time":1458369187386}
{"patch":[[[[0,"kdown\"}\n"],[1,"\"type(priv)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":14,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":14}]}\n"],[0,"\"type(pu"]],3854,3854,16,225]],"time":1458369183383}
{"patch":[[[[0,"_count\":"],[-1,"4"],[1,"29"],[0,",\"output"]],1858,1858,17,18],[[[0,"_count\":"],[-1,"5"],[1,"1"],[0,",\"output"]],2111,2111,17,17],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'pyelliptic' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-1-31e37a8dfe2c>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mCurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: name 'pyelliptic' is not defined\"]}"],[0,"]}\n\"# pyelli"]],2120,2120,24,797]],"time":1458369166361}
{"patch":[[[[0,"count\":2"],[1,"7"],[0,",\"output"]],1426,1426,16,17],[[[0,"_count\":"],[-1,"3"],[1,"28"],[0,",\"output"]],1734,1734,17,18]],"time":1458369162379}
{"patch":[[[[0,"_count\":"],[-1,"1"],[1,"22"],[0,",\"output"]],2113,2113,17,18],[[[0,"\":\"e"],[-1,"rror\",\"ename\":\"NameError\",\"evalue\":\"name 'pyelliptic' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-1-31e37a8dfe2c>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mCurve\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mpriv\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: name 'pyelliptic' is not defined\"]"],[1,"xecute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f199eab8518>\"},\"metadata\":{},\"execution_count\":22"],[0,"}]}\n"]],2148,2148,763,129]],"time":1458369158454}
{"patch":[[[[0,"\"}\n\""],[-1,"Curve "],[0,"= py"]],1995,1995,14,8]],"time":1458369154523}
{"patch":[[[[0,"down\"}\n\""],[-1,"= "],[0,"pyellipt"]],1991,1991,18,16]],"time":1458369150380}
{"patch":[[[[0,"kdown\"}\n"],[1,"\"ECDH(alice_pub, bob_priv) == ECDH(bob_pub, alice_priv)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":13,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'ECDH' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-13-e9f7bc5b74b3>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mECDH\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice_pub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mbob_priv\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m==\\u001b[0m \\u001b[0mECDH\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob_pub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0malice_priv\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: name 'ECDH' is not defined\"]}]}\n"],[0,"\"That is"]],3680,3680,16,1014]],"time":1458369098415}
{"patch":[[[[0,"_count\":"],[-1,"31"],[1,"26"],[0,",\"output"]],3404,3404,18,18]],"time":1458361447308}
{"patch":[[[[0,"nt\":"],[-1,"30"],[1,"25"],[0,",\"ou"]],2900,2900,10,10]],"time":1458361443308}
{"patch":[[[[0,"nt\":"],[-1,"27"],[1,"null"],[0,",\"ou"]],1429,1429,10,12],[[[0,"count\":2"],[-1,"8"],[1,"0"],[0,",\"output"]],1737,1737,17,17],[[[0,"count\":2"],[-1,"9"],[1,"1"],[0,",\"output"]],1863,1863,17,17]],"time":1458361439309}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"6"],[0,",\"outputs\":[]}\n\""]],1417,1417,36,33]],"time":1458361435313}
{"patch":[[[[0,"_count\":"],[-1,"null,\"outputs\":["],[1,"16,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"AttributeError\",\"evalue\":\"'str' object has no attribute 'get_ecdh_key'\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mAttributeError\\u001b[0m                            Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-16-245e7dc55af1>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpriv\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mAttributeError\\u001b[0m: 'str' object has no attribute 'get_ecdh_key'\"]}"],[0,"]}\n\"Our "]],5542,5542,32,952]],"time":1458361133677}
{"patch":[[[[0,"nt\":"],[1,"1"],[0,"2"],[-1,"6"],[0,",\"ou"]],3407,3407,10,10]],"time":1458360988889}
{"patch":[[[[0,"22}]}\n\"#"],[-1," "],[0,"pyellipt"]],2262,2262,17,16],[[[0,"count\":2"],[-1,"4,\"outputs\":["],[1,"3,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"Exception\",\"evalue\":\"[OpenSSL] EC_KEY_check_key FAIL ... error:100B106B:elliptic curve routines:EC_KEY_check_key:point is not on curve\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mException\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-23-82102ed5020c>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m__init__\\u001b[1;34m(self, pubkey, privkey, pubkey_x, pubkey_y, raw_privkey, curve)\\u001b[0m\\n\\u001b[0;32m     85\\u001b[0m             \\u001b[1;32mif\\u001b[0m \\u001b[0mprivkey\\u001b[0m \\u001b[1;32mis\\u001b[0m \\u001b[1;32mnot\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     86\\u001b[0m                 \\u001b[0mraw_privkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_privkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 87\\u001b[1;33m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_set_keys\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mraw_privkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     88\\u001b[0m         \\u001b[1;32melse\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     89\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_generate\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m_set_keys\\u001b[1;34m(self, pubkey_x, pubkey_y, privkey)\\u001b[0m\\n\\u001b[0;32m     90\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     91\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0m_set_keys\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mprivkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 92\\u001b[1;33m         \\u001b[1;32mif\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_check_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m<\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     93\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     94\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_check_key\\u001b[1;34m(self, privkey, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    365\\u001b[0m                 \\u001b[1;32mraise\\u001b[0m \\u001b[0mException\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m\\\"[OpenSSL] EC_KEY_set_public_key FAIL ... \\\"\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_error\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    366\\u001b[0m             \\u001b[1;32mif\\u001b[0m \\u001b[1;33m(\\u001b[0m\\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_check_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m==\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 367\\u001b[1;33m                 \\u001b[1;32mraise\\u001b[0m \\u001b[0mException\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m\\\"[OpenSSL] EC_KEY_check_key FAIL ... \\\"\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_error\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    368\\u001b[0m             \\u001b[1;32mreturn\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    369\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mException\\u001b[0m: [OpenSSL] EC_KEY_check_key FAIL ... error:100B106B:elliptic curve routines:EC_KEY_check_key:point is not on curve\"]}"],[0,"]}\n\"### "]],2375,2375,29,5568],[[[0,"_count\":"],[-1,"25"],[1,"11"],[0,",\"output"]],8433,8433,18,18]],"time":1458360984947}
{"patch":[[[[0,":22}]}\n\""],[-1,"#"],[0,"pyellipt"]],2261,2261,17,16]],"time":1458360980889}
{"patch":[[[[0,"_count\":"],[-1,"21"],[1,"8"],[0,",\"output"]],1859,1859,18,17],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":8}"],[0,"]}\n\"The keys"]],1868,1868,24,118],[[[0,"_count\":"],[-1,"22"],[1,"9"],[0,",\"output"]],2197,2197,18,17],[[[0,"99ea"],[-1,"b851"],[1,"9d75"],[0,"8>\"}"]],2309,2309,12,12],[[[0,"nt\":"],[-1,"22"],[1,"9"],[0,"}]}\n"]],2350,2350,10,9],[[[0,"_count\":"],[-1,"23"],[1,"10"],[0,",\"output"]],2464,2464,18,18],[[[0,"put-"],[-1,"23"],[1,"10"],[0,"-821"]],2889,2889,10,10]],"time":1458360927895}
{"patch":[[[[0,"_count\":"],[-1,"20"],[1,"7"],[0,",\"output"]],1733,1733,18,17],[[[0,",\"outputs\":["],[1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":7}"],[0,"]}\n\"pub = ke"]],1742,1742,24,118]],"time":1458360923901}
{"patch":[[[[0,"et_privkey()"],[1,"\\ntype(priv)"],[0,"\"︡{\"metadata"]],1643,1643,24,36],[[[0,"pubkey()"],[1,"\\ntype(pub)"],[0,"\"︡{\"meta"]],1878,1878,16,27]],"time":1458360903918}
{"patch":[[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],18128,18128,109,4]],"time":1458359836876}
{"patch":[[[[0,"]}\n\""],[-1,"Key Exchange\\n\\nSo how does Bob know the key actually belongs to Alice? There are two main schools of thought regarding the authentication of key ownership: centralised and decentralised. TLS/SSL follow the centralised school: a root certificate1 authority (CA) signs intermediary CA keys, which then sign user keys. For example, if Bob runs Foo Widgets, LLC, he can generate an SSL keypair. From this, he generates a certificate signing request, and sends this to the CA. The CA, usually after taking some money and ostensibly actually verifying Bob’s identity2, then signs Bob’s certificate. Bob sets up his webserver to use his SSL certificate for all secure traffic, and Alice sees that the CA did in fact sign his certificate. This relies on trusted central authorities, like VeriSign3 Alice’s web browser would ship with a keystore of select trusted CA public keys (like VeriSigns) that she could use to verify signatures on the certificates from various sites. This system is called a public key infrastructure. The other school of thought is followed by PGP4 - the decentralised model.\\n\\nIn PGP, this is manifested as the Web of Trust5. For example, if Carol now wants to talk to Bob and gives Bob her public key, Bob can check to see if Carol’s key has been signed by anyone else. We’ll also say that Bob knows for a fact that Alice’s key belongs to Alice, and he trusts her6, and that Alice has signed Carol’s key. Bob sees Alice’s signature on Carol’s key and then can be reasonably sure that Carol is who she says it was. If we repeat the process with Dave, whose key was signed by Carol (whose key was signed by Alice), Bob might be able to be more certain that the key belongs to Dave, but maybe he doesn’t really trust Carol to properly verify identities. Bob can mark keys as having various trust levels, and from this a web of trust emerges: a picture of how well you can trust that a given key belongs to a given user.\\n\\nThe key distribution problem is not a quick and easy problem to solve; a lot of very smart people have spent a lot of time coming up with solutions to the problem. There are key exchange protocols (such as the Diffie-Hellman key exchange7 and IKE8 (which uses Diffie-Hellman) that provide alternatives to the web of trust and public key infrastructures.\"︡{\"metadata\":{},\"cell_type\":\"markdown\""],[1,"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],15794,15794,2338,107]],"time":1458359832935}
{"patch":[[[[0,"nt\":"],[-1,"19,\"outputs\":[]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":"],[0,"null"]],15776,15776,111,8]],"time":1458359819907}
{"patch":[[[[0,"\"}\n\""],[-1,"def decrypt(pub, msg):\\n    \\\"\\\"\\\"\\n    Decrypt an ECIES-encrypted message with the private key.\\n    \\\"\\\"\\\"\\n    ephemeral_len = struct.unpack('>H', msg[:2])\\n    ephemeral_pub = msg[2:2+ephemeral_len]\\n    key = shared_key(priv, ephemeral_pub)\\n    return secretkey.decrypt(msg[2+ephemeral_len:], key)"],[0,"\"︡{\""]],15388,15388,311,8]],"time":1458359815901}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\"}\n\"\"︡{\"metadata\":{"],[0,"\"tru"]],15361,15361,50,8]],"time":1458359801865}
{"patch":[[[[0,"]}\n\""],[-1,"Encryption packs the public key at the beginning, writing first a 16-bit unsigned integer containing the public key length and then appending the ephemeral public key and the ciphertext to this. Decryption needs to unpack the ephemeral public key (by reading the length and extracting that many bytes from the message) and then decrypting the message with the shared key."],[0,"\"︡{\""]],14975,14975,379,8]],"time":1458359797901}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":18,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"ImportError\",\"evalue\":\"No module named secretkey\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mImportError\\u001b[0m                               Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-18-84786f8f4e33>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[1;32mimport\\u001b[0m \\u001b[0msecretkey\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[1;32mimport\\u001b[0m \\u001b[0mstruct\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      3\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      4\\u001b[0m \\u001b[1;32mdef\\u001b[0m \\u001b[0mencrypt\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mmsg\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m      5\\u001b[0m     \\\"\\\"\\\"\\n\",\"\\u001b[1;31mImportError\\u001b[0m: No module named secretkey\"]}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],13868,13868,1157,8]],"time":1458359779876}
{"patch":[[[[0,"\"}\n\""],[-1,"import secretkey\\nimport struct\\n\\ndef encrypt(pub, msg):\\n    \\\"\\\"\\\"\\n    Encrypt the message to the public key using ECIES. The public key\\n    should be a serialised public key.\\n    \\\"\\\"\\\"\\n    ephemeral = generate_key()\\n    key = shared_key(ephemeral, pub)\\n    ephemeral_pub = struct.pack('>H', len(ephemeral.get_public_key()))\\n    ephemeral += ephemeral.get_public_key()\\n    return ephemeral_pub+secretkey.encrypt(msg, key)"],[0,"\"︡{\""]],13393,13393,441,8]],"time":1458359775875}
{"patch":[[[[0,"[]}\n\"###"],[-1," "],[0,"Ephemera"]],12855,12855,17,16],[[[0,"al keys\\"],[-1,"n\\"],[0,"nFor imp"]],12870,12870,18,16],[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],13388,13388,109,4]],"time":1458359757862}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"###"],[0,"Ephemera"]],12852,12852,19,16],[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\""],[1,"\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],13360,13360,29,92]],"time":1458359753864}
{"patch":[[[[0,"]}\n\""],[-1,"Ephemeral keys\\nFor improved security, we should use ephemeral keys for encryption; that is, we generate a new elliptic curve key pair for each encryption operation. This works as long as we send the public key with the message. Let’s look at a sample EC encryption function. For this function, we need the public key of our recipient, and we’ll pack our key into the beginning of the function. This method of encryption is called the elliptic curve integrated encryption scheme, or ECIES."],[0,"\"︡{\""]],12856,12856,497,8]],"time":1458359749901}
{"patch":[[[[0,"_key"],[-1,"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":17,\"outputs\":[]}\n\""],[1,"\\n"],[0,"\"︡{\""]],12753,12753,111,10]],"time":1458359739865}
{"patch":[[[[0,"\"}\n\""],[-1,"def shared_key(priv, pub):\\n    \\\"\\\"\\\"Generate a new shared encryption key from a keypair.\\\"\\\"\\\"\\n    shared_key = priv.get_ecdh_key(pub)\\n    shared_key = shared_key[:32] + SHA384.new(shared_key[32:]).digest()\\n    return shared_key\\n"],[0,"\"︡{\""]],12520,12520,243,8]],"time":1458359735909}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\"}\n\"\"︡{\"metadata\":{"],[0,"\"tru"]],12493,12493,50,8]],"time":1458359721875}
{"patch":[[[[0,"]}\n\""],[-1,"Our shared key is 64 bytes; this is enough for AES-256 and HMAC-SHA-256. What about HMAC-SHA-256? We could use a short key, or we could expand the last 32 bytes of the key using SHA-384 (which produces a 48-byte hash). Here’s a function to do that:"],[0,"\"︡{\""]],12230,12230,256,8]],"time":1458359717913}
{"patch":[[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],10775,10775,36,35],[[[0,"_count\":"],[-1,"14"],[1,"null"],[0,",\"output"]],10826,10826,18,20],[[[0,"s\":["],[-1,"{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":14}"],[0,"]}\n\""]],10846,10846,103,8],[[[0,"rue,\"collapsed\":"],[-1,"fals"],[1,"tru"],[0,"e},\"cell_type\":\""]],10889,10889,36,35],[[[0,"nt\":"],[-1,"15,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":15}]}\n\"shared_key = priv.get_ecdh_key(pub)\\nlen(shared_key)\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":false},\"cell_type\":\"code\",\"execution_count\":16,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"AttributeError\",\"evalue\":\"'str' object has no attribute 'get_ecdh_key'\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mAttributeError\\u001b[0m                            Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-16-245e7dc55af1>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mshared_key\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mpriv\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_ecdh_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m      2\\u001b[0m \\u001b[0mlen\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mshared_key\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mAttributeError\\u001b[0m: 'str' object has no attribute 'get_ecdh_key'\"]}]}\n\""],[1,"null,\"outputs\":[]}\n\"shared_key = priv.get_ecdh_key(pub)\\nlen(shared_key)"],[0,"\"︡{\""]],10944,10944,1199,80]],"time":1458359697913}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"type(pub)"],[0,"\"︡{\"meta"]],10846,10846,25,16],[[[0,"s\":[]}\n\""],[1,"\\n\\n"],[0,"shared_k"]],10951,10951,16,20]],"time":1458359693876}
{"patch":[[[[0,"s\":[]}\n\""],[1,"type(pub)"],[0,"\\n\\nshar"]],10951,10951,16,25]],"time":1458359689874}
{"patch":[[[[0,"[]}\n"],[-1,"\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n"],[0,"\"typ"]],10849,10849,113,8]],"time":1458359685875}
{"patch":[[[[0,"riv)"],[-1,"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}\n\""],[1,"\\n\\n"],[0,"type"]],10745,10745,113,12]],"time":1458359681877}
{"patch":[[[[0,"\"}\n\""],[-1,"type(priv)\\n\\ntype(pub)\\n\\nshared_key = priv.get_ecdh_key(pub)\\nlen(shared_key)"],[0,"\"︡{\""]],10735,10735,87,8]],"time":1458359675900}
{"patch":[[[[0,"key."],[-1,"\\nWith pyelliptic, the private key used must be an instance of pyelliptic.ecc.ECC; the public key must be in serialised form."],[0,"\"︡{\""]],10568,10568,133,8]],"time":1458359640889}
{"patch":[[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],10608,10608,109,4]],"time":1458359633866}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\""],[1,"\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],10583,10583,29,92]],"time":1458359629865}
{"patch":[[[[0,"]}\n\""],[-1,"That is, ECDH with Alice’s private key and Bob’s public key returns the same shared key as ECDH with Bob’s private key and Alice’s public key."],[0,"\"︡{\""]],10426,10426,150,8]],"time":1458359625900}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":13,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"NameError\",\"evalue\":\"name 'ECDH' is not defined\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-13-e9f7bc5b74b3>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mECDH\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0malice_pub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mbob_priv\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m==\\u001b[0m \\u001b[0mECDH\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mbob_pub\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0malice_priv\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;31mNameError\\u001b[0m: name 'ECDH' is not defined\"]}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],9524,9524,952,8]],"time":1458359612871}
{"patch":[[[[0,"\"}\n\""],[-1,"ECDH(alice_pub, bob_priv) == ECDH(bob_pub, alice_priv)"],[0,"\"︡{\""]],9428,9428,62,8]],"time":1458359608904}
{"patch":[[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],9426,9426,109,4]],"time":1458359603865}
{"patch":[[[[0,"s\":[]}\n\""],[-1,"### "],[0,"Encrypti"]],9165,9165,20,16],[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\""],[1,"\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],9397,9397,29,92]],"time":1458359599876}
{"patch":[[[[0,"]}\n\""],[-1,"Encryption\\n\\nUsing elliptic curves, we encrypt using a function that generates a symmetric key using a public and private key pair. The function that we use, ECDH (elliptic curve Diffie-Hellman), works such that:"],[0,"\"︡{\""]],9169,9169,221,8]],"time":1458359595905}
{"patch":[[[[0,"nt\":"],[-1,"12,\"outputs\":[]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":"],[0,"null"]],9151,9151,111,8]],"time":1458359588875}
{"patch":[[[[0,"\"}\n\""],[-1,"def verify(pub, msg, sig):\\n    \\\"\\\"\\\"Verify the signature on a message.\\\"\\\"\\\"\\n    return pyelliptic.ECC(curve='secp521r1', pubkey=pub).verify(sig, msg)"],[0,"\"︡{\""]],8913,8913,161,8]],"time":1458359584876}
{"patch":[[[[0,"]}\n\""],[-1,"In order to verify a message, we need the public key for the signing key, the message, and the signature. We’ll expect a serialised public key and perform the import to a pyelliptic.ecc.ECC instance internally.\"︡{\"metadata\":{},\"cell_type\":\"markdown\""],[1,"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}\n\"\""]],8661,8661,257,110]],"time":1458359567880}
{"patch":[[[[0,":[]}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],8764,8764,109,4]],"time":1458359564005}
{"patch":[[[[0,"nt\":"],[-1,"11,\"outputs\":[]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":"],[0,"null"]],8643,8643,111,8]],"time":1458359555871}
{"patch":[[[[0,"\"}\n\""],[-1,"def sign(key, msg):\\n    \\\"\\\"\\\"Sign a message with the ECDSA key.\\\"\\\"\\\"\\n    return key.sign(msg)"],[0,"\"︡{\""]],8461,8461,105,8]],"time":1458359551905}
{"patch":[[[[0,"e\"]}]}\n\""],[-1,"### "],[0,"Signing "]],8137,8137,20,16],[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],8455,8455,109,4]],"time":1458359534876}
{"patch":[[[[0,"]}\n\""],[-1,"Signing Messages\\n\\nNormally when we do signatures, we compute the hash of the message and sign that. PyElliptic does this for us, using SHA-512. Signing messages is done with the private key and some message. The algorithm used by PyElliptic for signatures is called ECDSA."],[0,"\"︡{\""]],8141,8141,282,8]],"time":1458359530901}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\""],[1,"\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],8156,8156,29,92]],"time":1458359526913}
{"patch":[[[[0,"_count\":"],[-1,"10"],[1,"5"],[0,",\"output"]],2580,2580,18,17],[[[0,"n-input-"],[-1,"10"],[1,"5"],[0,"-82102ed"]],3000,3000,18,17]],"time":1458359397885}
{"patch":[[[[0,"_count\":"],[-1,"6"],[1,"null"],[0,",\"output"]],1425,1425,17,20],[[[0,"_count\":"],[-1,"7"],[1,"2"],[0,",\"output"]],1748,1748,17,17],[[[0,"_count\":"],[-1,"7"],[1,"2"],[0,"}]}\n\"pub"]],1853,1853,17,17],[[[0,"_count\":"],[-1,"8"],[1,"3"],[0,",\"output"]],1978,1978,17,17],[[[0,"_count\":"],[-1,"8"],[1,"3"],[0,"}]}\n\"The"]],2083,2083,17,17],[[[0,"_count\":"],[-1,"9"],[1,"4"],[0,",\"output"]],2316,2316,17,17],[[[0,"f199"],[-1,"ea9d75"],[1,"f398bd"],[0,"8>\"}"]],2426,2426,14,14],[[[0,"_count\":"],[-1,"9"],[1,"4"],[0,"}]}\n\"pye"]],2465,2465,17,17]],"time":1458359393877}
{"patch":[[[[0,"xecution_count\":"],[-1,"null"],[1,"1"],[0,",\"outputs\":[]}\n\""]],1417,1417,36,33]],"time":1458359389874}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":5,\"outputs\":[{\"output_type\":\"error\",\"ename\":\"Exception\",\"evalue\":\"[OpenSSL] EC_KEY_check_key FAIL ... error:100B106B:elliptic curve routines:EC_KEY_check_key:point is not on curve\",\"traceback\":[\"\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m\",\"\\u001b[1;31mException\\u001b[0m                                 Traceback (most recent call last)\",\"\\u001b[1;32m<ipython-input-5-82102ed5020c>\\u001b[0m in \\u001b[0;36m<module>\\u001b[1;34m()\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[1;33m \\u001b[0mpyelliptic\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mECC\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey\\u001b[0m\\u001b[1;33m=\\u001b[0m\\u001b[0mpub\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m__init__\\u001b[1;34m(self, pubkey, privkey, pubkey_x, pubkey_y, raw_privkey, curve)\\u001b[0m\\n\\u001b[0;32m     85\\u001b[0m             \\u001b[1;32mif\\u001b[0m \\u001b[0mprivkey\\u001b[0m \\u001b[1;32mis\\u001b[0m \\u001b[1;32mnot\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     86\\u001b[0m                 \\u001b[0mraw_privkey\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mECC\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_decode_privkey\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 87\\u001b[1;33m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_set_keys\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mraw_privkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     88\\u001b[0m         \\u001b[1;32melse\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     89\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0m_generate\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36m_set_keys\\u001b[1;34m(self, pubkey_x, pubkey_y, privkey)\\u001b[0m\\n\\u001b[0;32m     90\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     91\\u001b[0m     \\u001b[1;32mdef\\u001b[0m \\u001b[0m_set_keys\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mprivkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m---> 92\\u001b[1;33m         \\u001b[1;32mif\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mraw_check_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mprivkey\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_x\\u001b[0m\\u001b[1;33m,\\u001b[0m \\u001b[0mpubkey_y\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m<\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m     93\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_x\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m     94\\u001b[0m             \\u001b[0mself\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mpubkey_y\\u001b[0m \\u001b[1;33m=\\u001b[0m \\u001b[0mNone\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;32m/projects/7171577f-a330-4f46-8f6d-303bd01a7bdc/.local/lib/python2.7/site-packages/pyelliptic-1.5.7-py2.7.egg/pyelliptic/ecc.pyc\\u001b[0m in \\u001b[0;36mraw_check_key\\u001b[1;34m(self, privkey, pubkey_x, pubkey_y)\\u001b[0m\\n\\u001b[0;32m    365\\u001b[0m                 \\u001b[1;32mraise\\u001b[0m \\u001b[0mException\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m\\\"[OpenSSL] EC_KEY_set_public_key FAIL ... \\\"\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_error\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    366\\u001b[0m             \\u001b[1;32mif\\u001b[0m \\u001b[1;33m(\\u001b[0m\\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mEC_KEY_check_key\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[0mkey\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m \\u001b[1;33m==\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m:\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m--> 367\\u001b[1;33m                 \\u001b[1;32mraise\\u001b[0m \\u001b[0mException\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;34m\\\"[OpenSSL] EC_KEY_check_key FAIL ... \\\"\\u001b[0m \\u001b[1;33m+\\u001b[0m \\u001b[0mOpenSSL\\u001b[0m\\u001b[1;33m.\\u001b[0m\\u001b[0mget_error\\u001b[0m\\u001b[1;33m(\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m)\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[0;32m    368\\u001b[0m             \\u001b[1;32mreturn\\u001b[0m \\u001b[1;36m0\\u001b[0m\\u001b[1;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m    369\\u001b[0m \\u001b[1;33m\\u001b[0m\\u001b[0m\\n\",\"\\u001b[1;31mException\\u001b[0m: [OpenSSL] EC_KEY_check_key FAIL ... error:100B106B:elliptic curve routines:EC_KEY_check_key:point is not on curve\"]}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],2540,2540,5649,8]],"time":1458359372885}
{"patch":[[[[0,"]}\n\""],[-1,"pyelliptic.ECC(pubkey=pub)"],[0,"\"︡{\""]],2472,2472,34,8]],"time":1458359368905}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":4,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"<pyelliptic.ecc.ECC instance at 0x7f199f398bd8>\"},\"metadata\":{},\"execution_count\":4}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],2273,2273,249,8]],"time":1458359361872}
{"patch":[[[[0,"\"}\n\""],[-1,"pyelliptic.ECC(privkey=priv)"],[0,"\"︡{\""]],2203,2203,36,8]],"time":1458359357909}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\"}\n\"\"︡{\"metadata\":{"],[0,"\"tru"]],2176,2176,50,8]],"time":1458359349867}
{"patch":[[[[0,"]}\n\""],[-1,"The keys can be imported when instantiating a instance of the ECC class"],[0,"\"︡{\""]],2090,2090,79,8]],"time":1458359345900}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":3,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":3}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],1935,1935,205,8]],"time":1458359336883}
{"patch":[[[[0,"]}\n\""],[-1,"pub = key.get_pubkey()\\ntype(pub)"],[0,"\"︡{\""]],1860,1860,41,8]],"time":1458359332900}
{"patch":[[[[0,"ed\":"],[-1,"false},\"cell_type\":\"code\",\"execution_count\":2,\"outputs\":[{\"output_type\":\"execute_result\",\"data\":{\"text/plain\":\"str\"},\"metadata\":{},\"execution_count\":2}]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":"],[0,"true"]],1705,1705,205,8]],"time":1458359327864}
{"patch":[[[[0,"\"}\n\""],[-1,"key = generate_key()\\npriv = key.get_privkey()\\ntype(priv)"],[0,"\"︡{\""]],1605,1605,66,8]],"time":1458359323912}
{"patch":[[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],1603,1603,109,4]],"time":1458359307867}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\""],[1,"\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]"],[0,"}"]],1578,1578,29,92]],"time":1458359303914}
{"patch":[[[[0,"]}\n\""],[-1,"Public and private keys can be exported (i.e. for storage) using the accessors (the examples shown are for Python 2)."],[0,"\"︡{\""]],1446,1446,125,8]],"time":1458359294909}
{"patch":[[[[0,"nt\":"],[-1,"1,\"outputs\":[]}\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":"],[0,"null"]],1429,1429,110,8]],"time":1458359286908}
{"patch":[[[[0,"elliptic"],[1,"\\n2 \\n3 "],[0,"\\ndef ge"]],1272,1272,16,24]],"time":1458359282871}
{"patch":[[[[0,"2 \\n3 \\n"],[1,"4 "],[0,"def gene"]],1282,1282,16,18],[[[0,"key():\\n"],[1,"5"],[0,"     ret"]],1305,1305,16,17]],"time":1458359278871}
{"patch":[[[[0,"\"}\n\""],[-1,"import pyelliptic\\n2 \\n3 \\n4 def generate_key():\\n5     return pyelliptic.ECC(curve='secp521r1')"],[0,"\"︡{\""]],1259,1259,104,8]],"time":1458359274909}
{"patch":[[[[0,"a\":{"],[-1,"},\"cell_type\":\"markdown\"}\n\"\"︡{\"metadata\":{"],[0,"\"tru"]],1232,1232,50,8]],"time":1458359268900}
{"patch":[[[[0,"\"}\n\""],[-1,"### "],[0,"Gene"]],1079,1079,12,8]],"time":1458359264865}
{"patch":[[[[0,"\"}\n\""],[-1,"Generating Keys\\n\\nGenerating new keys with PyElliptic is done with the ECC class. As we used AES-256 previously, we’ll use P521 here."],[0,"\"︡{\""]],1079,1079,142,8]],"time":1458359260901}
{"patch":[[[[0,"wn\"}"],[-1,"\n\"\"︡{\"metadata\":{\"trusted\":true,\"collapsed\":true},\"cell_type\":\"code\",\"execution_count\":null,\"outputs\":[]}"]],1077,1077,109,4]],"time":1458359253890}
{"patch":[[[[0,"secp384r1)\\n"],[-1,"- "],[0,"the NIST P52"]],760,760,26,24],[[[0,"p521r1)\\"],[-1,"n\\"],[0,"nAlterna"]],849,849,18,16]],"time":1458359250387}
{"patch":[[[[0,"phy:\\n\\n"],[-1,"- "],[0,"the NIST"]],588,588,18,16],[[[0,"256r1)\\n"],[-1,"- "],[0,"the NIST"]],674,674,18,16]],"time":1458359245885}
{"patch":[[[[0,"to Bob.\\"],[-1,"n\\"],[0,"nThere a"]],508,508,18,16]],"time":1458359241885}
{"patch":[[[[0,"c key.\\n"],[-1,"- "],[0,"Encrypti"]],317,317,18,16]],"time":1458359237883}
{"patch":[[[[0,"}\n\"## EC"],[-1,"C"],[0,"\\n\\nWith"]],31,31,17,16],[[[0,"\\n\\n"],[-1,"- "],[0,"Digi"]],134,134,10,8]],"time":1458359233886}
{"patch":[[[[0,"\"}\n\""],[-1,"## EC"],[0,"\\n\\n"]],30,30,13,8]],"time":1458359229881}
{"patch":[[[[0,"\"}\n\""],[-1,"\\n\\nWith elliptic curves, we have two types of operations that we generally want to accomplish:\\n\\nDigital signatures are the public key equivalent of message authentication codes. Alice signs a document using her private key, and users verify the signature against her public key.\\nEncryption with elliptic curves is done by performing a key exchange. Alice uses a function called elliptic curve Diffie-Hellman (ECDH) to generate a shared key to encrypt messages to Bob.\\nThere are three curves we generally use with elliptic curve cryptography:\\n\\nthe NIST P256 curve, which is equivalent to an AES-128 key (also known as secp256r1)\\nthe NIST P384 curve, which is equivalent to an AES-192 key (also known as secp384r1)\\nthe NIST P521 curve, which is equivalent to an AES-256 key (also known as secp521r1)\\nAlternatively, there is the Curve25519 curve, which can be used for key exchange, and the Ed25519 curve, which can be used for digital signatures."],[0,"\"︡{\""]],30,30,962,8]],"time":1458359225887}
{"patch":[[[[-1,"{\"notebook_name\":\"03_ECC.ipynb\"}\n\"\"︡{\"metadata\":{\"collapsed\":false,\"trusted\":false},\"cell_type\":\"markdown\"}"]],0,0,107,0]],"time":1458359221904}